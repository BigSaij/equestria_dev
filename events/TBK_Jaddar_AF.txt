add_namespace = TBK_AF_event_start
add_namespace = TBK_AF_event_general
add_namespace = TBK_AF_event_military 
add_namespace = TBK_AF_event_news

## starting events

	news_event = {
		id = TBK_AF_event_news.1
		immediate = { log = "[GetDateText]: [Root.GetName]: event TBK_AF_event_news.1" }
		title = TBK_AF_event_news.1.t
		desc = TBK_AF_event_news.1.d

		picture = GFX_event_TBK_AF_magical_anomaly
		is_triggered_only = yes

		option = { ### generic
			name = TBK_AF_event_start.1.a
			trigger = {
				NOT = {
					tag = EQS
				}
			}
			if = {
				limit = {
					is_ai = no
				}
				hidden_effect = {
					country_event = { id = TBK_AF_event_start.1 days = 1 }
				}
			}
		}
		option = { ### for Equestria about needing to consult Celestia
			name = TBK_AF_event_start.1.b
			trigger = {
				tag = EQS
			}
			hidden_effect = {
				country_event = { id = TBK_AF_event_start.2 days = 1 }
			}
		}
	}

	country_event = { ### Event for non-EQS tags about something happening in Tobuck following the magical anomaly
		id = TBK_AF_event_start.1
		immediate = { 
			log = "[GetDateText]: [Root.GetName]: event TBK_AF_event_start.1" 
		}
		title = TBK_AF_event_start.1.t
		desc = {
			text = TBK_AF_event_start.1.d.tbk
			trigger = {
				tag = TBK
			}
		}
		desc = {
			text = TBK_AF_event_start.1.d
			trigger = {
				NOT = {
					tag = TBK
				}
			}
		}

		is_triggered_only = yes

		option = { ## play as TBK UNAVAILABLE FOR AI
			name = TBK_AF_event_start.1.a
			trigger = {
				ROOT = {
					NOT = {
						tag = TBK
					}
				}
			}

			TBK = { 
				change_tag_from = ROOT
				load_focus_tree = {
					tree = TBK_AF_jaddars_arrival
					keep_completed = no
				}
			}
		}
		option = { ## don't play as TBK
			name = TBK_AF_event_start.1.b
			trigger = {
				NOT = {
					tag = TBK
				}
			}

			hidden_effect = {
				TBK = {
					if = {
						limit = {
							is_ai = yes
						}
						load_focus_tree = {
							tree = TBK_AF_jaddars_arrival
							keep_completed = no
						}
					}
				}
			}
		}
		option = { ## option if player is TBK
			name = TBK_AF_event_start.1.c
			trigger = {
				tag = TBK
			}
			
			load_focus_tree = {
				tree = TBK_AF_jaddars_arrival
				keep_completed = no
			}
		}
	}

	country_event = { ### Event for EQS about Celestia going missing following the magical anomaly and Twilight&Luna needing to step in to help
		id = TBK_AF_event_start.2
		immediate = { log = "[GetDateText]: [Root.GetName]: event TBK_AF_event_start.2" }
		title = TBK_AF_event_start.2.t
		desc = TBK_AF_event_start.2.d

		is_triggered_only = yes

		option = {
			name = TBK_AF_event_start.2.a ## play as TBK UNAVAILABLE FOR AI
			trigger = {
				ROOT = {
					is_ai = no
				}
			}
			hidden_effect = {
				EQS_princess_celestia = {
					set_character_name = TBK_AF_celestia
					set_portraits = {
						civilian={
							large = "gfx/leaders/TBK_AF/suslestia.tga"
						}
					}
				}
			}
			TBK = { 
				change_tag_from = ROOT
				load_focus_tree = {
					tree = TBK_AF_jaddars_arrival
					keep_completed = no
				}
			}
		}
		option = {
			name = TBK_AF_event_start.2.b ## don't play as TBK
			hidden_effect = {
				EQS_princess_celestia = {
					set_portraits = {
						civilian={
							large ="gfx/leaders/TBK_AF/suslestia.tga"
						}
					}
				}
				TBK = {
					if = {
						limit = {
							is_ai = yes
						}
						load_focus_tree = {
							tree = TBK_AF_jaddars_arrival
							keep_completed = no
						}
					}
				}
			}
		}
	}

	country_event = { ### Jaddar wanders into deserts of Tobuck atop his mount, Jahorse LXIV
		id = TBK_AF_event_start.3
		immediate = { log = "[GetDateText]: [Root.GetName]: event TBK_AF_event_start.3" }
		title = TBK_AF_event_start.3.t
		desc = TBK_AF_event_start.3.d

		is_triggered_only = yes

		option = {
			name = TBK_AF_event_start.3.a
			TBK_AF_jaddar_jexiszuir = {
				set_nationality = ROOT
			}
			TBK_AF_jahorse = {
				set_nationality = ROOT
			}
			clr_country_flag = TBK_is_hiding_deal
			country_event = { id = TBK_AF_event_start.4 days = 1 }
		}
	}

	country_event = { ### Jaddar arrives at a village being attacked by a monster and he rides in to help
		id = TBK_AF_event_start.4
		immediate = { log = "[GetDateText]: [Root.GetName]: event TBK_AF_event_start.4" }
		title = TBK_AF_event_start.4.t
		desc = TBK_AF_event_start.4.d

		is_triggered_only = yes

		option = { ### Jaddar helps to organise the ponies to escape, aiding stragglers to escape
			name = TBK_AF_event_start.4.a
			### add a hint tooltip about being a ruler
			country_event = { id = TBK_AF_event_start.5 }
		}
		option = { ### Jaddar fights off the monster to drive it away
			name = TBK_AF_event_start.4.b
			### add a hint tooltip about being a military strategist
			country_event = { id = TBK_AF_event_start.6 }
		}
	}

	country_event = { ### Outcome event for Jaddar choosing to lead the villagers away and help them escape - introduces Light Bringer, recurring character
		id = TBK_AF_event_start.5
		immediate = { log = "[GetDateText]: [Root.GetName]: event TBK_AF_event_start.5" }
		title = TBK_AF_event_start.5.t
		desc = TBK_AF_event_start.5.d

		is_triggered_only = yes

		option = {
			name = TBK_AF_event_start.5.a
			### unlocks the lifestyle window showing Jaddar's personal growth
			### give Sovereign trait tree experience points
		}
	}


	country_event = { ### Outcome event for Jaddar choosing to drive away the monster - introduces Light Bringer, recurring character
		id = TBK_AF_event_start.6
		immediate = { log = "[GetDateText]: [Root.GetName]: event TBK_AF_event_start.6" }
		title = TBK_AF_event_start.6.t
		desc = TBK_AF_event_start.6.d

		is_triggered_only = yes

		option = {
			name = TBK_AF_event_start.6.a
			### unlocks the lifestyle window showing Jaddar's personal growth
			### give Commander trait tree experience points
		}
	}

	country_event = {  ### fired by completing The Herald Arrives -focus - Jaddar rests in the village and figures out what has happened to him, realizes he has new magival powers
		id = TBK_AF_event_start.7
		immediate = { log = "[GetDateText]: [Root.GetName]: event TBK_AF_event_start.7" }
		title = TBK_AF_event_start.7.t
		desc = TBK_AF_event_start.7.d

		is_triggered_only = yes

		option = {
			name = TBK_AF_event_start.7.a
			### add a hint tooltip about religious conversion being a big system
			### give Judge trait tree experience points
			country_event = { id = TBK_AF_event_start.8 days = 3 }
		}
	}

	country_event = { ### Wallnut hears about Jaddar and heads out to investigate, ends up meeting him and instantly wants to be his friend
		id = TBK_AF_event_start.8
		immediate = { log = "[GetDateText]: [Root.GetName]: event TBK_AF_event_start.8" }
		title = TBK_AF_event_start.8.t
		desc = TBK_AF_event_start.8.d

		is_triggered_only = yes

		option = { ### Jaddar talks to Wallnut about the faith
			name = TBK_AF_event_start.8.a
			hidden_effect = {
				country_event = { id = TBK_AF_event_start.9 days = 3 }
			}
		}
	}

	country_event = { ### Pea Shooter sends Baragzen and Alesia to check in and deal with the growing rural unrest caused by the rumours of a god
		id = TBK_AF_event_start.9
		immediate = { log = "[GetDateText]: [Root.GetName]: event TBK_AF_event_start.9" }
		title = TBK_AF_event_start.9.t
		desc = TBK_AF_event_start.9.d

		is_triggered_only = yes

		option = {
			name = TBK_AF_event_start.9.a
			add_stability = -0.15
			add_war_support = -0.15
			add_popularity = { ideology = neutrality popularity = -0.1 }
		}
	}

	country_event = { ### Baragzen and Alesia meet up with Jaddar (with Wallnut tagging along) who then convinces them to join him
		id = TBK_AF_event_start.10 
		immediate = { log = "[GetDateText]: [Root.GetName]: event TBK_AF_event_start.10" }
		title = TBK_AF_event_start.10.t
		desc = TBK_AF_event_start.10.d

		is_triggered_only = yes

		option = { ### Jaddar convinces them via divine powers
			name = TBK_AF_event_start.10.a
			### give Judge trait tree experience points
			hidden_effect = {
				country_event = { id = TBK_AF_event_start.11 days = 3 }
			}
		}
		option = { ### Jaddar convinces them via his commanding presence
			name = TBK_AF_event_start.10.b
			### give Commander trait tree experience points
			hidden_effect = {
				country_event = { id = TBK_AF_event_start.11 days = 3 }
			}
		}
		option = { ### Jaddar convinces them via his graceful existence
			name = TBK_AF_event_start.10.c
			### give Sovereign trait tree experience points
			hidden_effect = {
				country_event = { id = TBK_AF_event_start.11 days = 3 }
			}
		}
	}

	country_event = { ### Jaddar's following grows, PoV event of Light Bringer, now a sort of ad-hoc leader, organising a march towards city of Tobuck of followers and mercs
		id = TBK_AF_event_start.11
		immediate = { log = "[GetDateText]: [Root.GetName]: event TBK_AF_event_start.10" }
		title = TBK_AF_event_start.11.t
		desc = TBK_AF_event_start.11.d

		is_triggered_only = yes

		option = {
			name = TBK_AF_event_start.11.a
			add_popularity = { ideology = democratic popularity = 0.1 }
			hidden_effect = {
				country_event = { id = TBK_AF_event_start.12 days = 3 }
			}
		}
	}

	country_event = { ### Jaddar is led into city of Tobuck where he accidentally stumbles upon Pea trying to flee but whom Jaddar then elevates, declaring his intention to bring light of Surael to this world and its people
		id = TBK_AF_event_start.12
		immediate = { log = "[GetDateText]: [Root.GetName]: event TBK_AF_event_start.12" }
		title = TBK_AF_event_start.12.t
		desc = TBK_AF_event_start.12.d

		is_triggered_only = yes

		option = {
			name = TBK_AF_event_start.12.a
			set_country_flag = TBK_AF_state_view_flag
			remove_ideas = TBK_warlord_reliance
			### tooltip about Jaddar and Jahorse becoming field marshals
			remove_country_leader_role = {
				character = TBK_pea_shooter
				ideology = oligarchism
			}
			add_country_leader_role = {
				character = TBK_AF_jaddar_jexiszuir
				country_leader = {
					expire = "1965.1.1"
					ideology = theocracy_subideology
					traits = {  }
				}
				promote_leader = yes
			}
			set_country_leader_description = {
				ideology = neutrality
				desc = TBK_AF_jaddar_jexiszuir_desc
			}
			remove_advisor_role = {
				slot = political_advisor
				character = TBK_giggle_juice
			}
			set_cosmetic_tag = TBK_AF
			load_focus_tree = {
				tree = TBK_AF_jadd_empire
				keep_completed = no
			}
		}
	}

## main tree events

	country_event = {
		id = TBK_AF_event_military.1
		immediate = { log = "[GetDateText]: [Root.GetName]: event TBK_AF_event_military.1" }
		title = TBK_AF_event_military.1.t
		desc = TBK_AF_event_military.1.d

		is_triggered_only = yes

		option = {
			name = TBK_AF_event_military.1.a
			TBK_AF_jaddar_jexiszuir = {
				add_defense = 1
				add_attack = 1
				add_planning = 1
				add_logistics = 1
			}
			add_doctrine_cost_reduction = {
				name = land_doc_bonus
				cost_reduction = 0.5
				uses = 1
				category = land_doctrine
			}
		}
	}
