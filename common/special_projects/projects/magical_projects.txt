sp_what_is_friendship = {
	specialization = specialization_magical
	icon = GFX_sp_magical_what_is_friendship


	project_tags = {
		sp_tag_magical
	}

	ai_will_do = {
		base = 1
	}

	allowed = {
		always = yes
	}
	
	available = {
		always = no
	}
	
	prototype_time = 1

	complexity = sp_complexity.insane
	
	project_output = {
		country_effects = {
			add_political_power = 100
		}
	}

	generic_prototype_rewards = {
		sp_land_generic_reward_scientist_xp_1
		#sp_land_generic_reward_scientist_xp_2
		#sp_land_generic_reward_scientist_xp_3
		#sp_land_generic_reward_army_xp_1
		#sp_land_generic_reward_army_xp_2
		#sp_land_generic_reward_army_xp_3
		#sp_land_generic_reward_major_progress_1
		#sp_land_generic_reward_major_progress_2
		#sp_land_generic_reward_major_progress_3
		#sp_land_generic_reward_test_failure_1
		#sp_land_generic_reward_test_failure_2
		#sp_land_generic_reward_test_failure_3
		#sp_land_generic_reward_armor_tech_1
		#sp_land_generic_reward_armor_tech_2
		#sp_land_generic_reward_armor_tech_3
		#sp_land_generic_reward_artillery_tech_1
		#sp_land_generic_reward_artillery_tech_2
		#sp_land_generic_reward_artillery_tech_3
		#sp_land_generic_reward_armor_bonus_1
		#sp_land_generic_reward_armor_bonus_2
		#sp_land_generic_reward_armor_bonus_3
		#sp_land_generic_reward_engine_bonus_1
		#sp_land_generic_reward_engine_bonus_2
		#sp_land_generic_reward_engine_bonus_3
		#sp_land_generic_reward_artillery_bonus_1
		#sp_land_generic_reward_artillery_bonus_2
		#sp_land_generic_reward_artillery_bonus_3
		#sp_land_generic_reward_resource_scarcity
		#sp_land_generic_reward_critical_failure
	}

	unique_prototype_rewards = {
#		sp_TEST_reward = {
#			fire_only_once = yes
#	
#				threshold = { 
#					min = 0
#					max = 100
#				}
#	
#				weight = {
#					base = 99999
#				}
#	
#				option = {
#					token = sp_TEST_option
#	
#					iteration_output = {
#						country_effects = {
#							
#						}
#	
#						scientist_effects = {
#	
#						}
#	
#						facility_state_effects = {
#	
#						}
#					}
#			}
#		}
	}
}

######################################
######################################

  ###  #### #    # #### ###  #   ##
 #     #    ##   # #    #  # #  #  #
 #  ## ###  # #  # ###  ###  # #
 #   # #    #  # # #    # #  #  #  #
  ###  #### #   ## #### #  # #   ##

######################################
######################################

sp_magical_telekinetic_fields = { ## Induced Telekinetic Fields
	specialization = specialization_magical
	icon = GFX_sp_magical_telekinetic_fields

	project_tags = {
		sp_tag_magical
	}

	resource_cost = {
		resources = { 
			crystals = 3
		 }
	}

	ai_will_do = {
		base = 1
	}

	complexity = sp_complexity.medium
	prototype_time = sp_time.prototype.medium
	breakthrough_cost = {
		specialization_magical = 1
	}

	available = {
		FROM = {
			has_tech = magical_weapons1
		}
	}

	project_output = {
		country_effects = {
			if = {
				limit = {
					NOT = {
						AND = {
							has_dlc = "Man the Guns"
							has_dlc = "No Step Back"
							has_dlc = "By Blood Alone"
						}
					}
				}
				add_ideas = sp_magical_telekinetic_field_no_dlc
			}
			else_if = {
				limit = {
					NOT = {
						has_dlc = "Man the Guns"
						has_dlc = "No Step Back"
						has_dlc = "By Blood Alone"
					}
				}
				if = {
					limit = {
						has_dlc = "No Step Back"
						has_dlc = "By Blood Alone"
					}
					add_ideas = sp_magical_telekinetic_field_no_mta
				}
				else_if = {
					limit = {
						has_dlc = "By Blood Alone"
					}
					add_ideas = sp_magical_telekinetic_field_no_mta_nsb
				}
				else_if = {
					limit = {
						has_dlc = "No Step Back"
					}
					add_ideas = sp_magical_telekinetic_field_no_mta_bba
				}
				else_if = {
					limit = {
						has_dlc = "Man the Guns"
						has_dlc = "By Blood Alone"
					}
					add_ideas = sp_magical_telekinetic_field_no_nsb
				}
				else_if = {
					limit = {
						has_dlc = "Man the Guns"
					}
					add_ideas = sp_magical_telekinetic_field_no_nsb_bba
				}
				else_if = {
					limit = {
						has_dlc = "Man the Guns"
						has_dlc = "No Step Back"
					}
					add_ideas = sp_magical_telekinetic_field_no_bba
				}
			}
		}
		enable_equipment_modules = {
			#### add the unique modules here
		}
	}

	generic_prototype_rewards = {
		### need to add xp & breakthrough rewards
	}
}

sp_magical_assisted_quarries = { ## Magic-Assisted Quarries
	specialization = specialization_magical
	icon = GFX_sp_magical_magitech_quarries

	project_tags = {
		sp_tag_magical
	}

	resource_cost = {
		resources = { 
			crystals = 3
		 }
	}

	ai_will_do = {
		base = 1
	}

	complexity = sp_complexity.medium
	prototype_time = sp_time.prototype.medium
	breakthrough_cost = {
		specialization_magical = 1
	}

	available = {
		FROM = {
			has_tech = excavation3
		}
	}

	project_output = {
		country_effects = {
			
			custom_override_tooltip = {
				tooltip = {
					localization_key = SP_UNLOCK_BUILDING_ICON_DESC
					BUILDING = magical_quarry
					BUILDING_DESCRIPTION = magical_quarry_desc
					ICON_FRAME = 30
				}
				set_technology = {
					tech_magical_quarry = 1
					popup = no
				}
			}
			mark_technology_tree_layout_dirty = yes
		}
	}

	generic_prototype_rewards = {
		### need to add xp & breakthrough rewards
	}
}

sp_magical_supply_organisation = { ## Magitech Depot Organisation
	specialization = specialization_magical
	icon = GFX_sp_magical_magitech_depot_org

	project_tags = {
		sp_tag_magical
	}

	resource_cost = {
		resources = { 
			crystals = 3
		 }
	}

	ai_will_do = {
		base = 1
	}

	complexity = sp_complexity.medium
	prototype_time = sp_time.prototype.medium
	breakthrough_cost = {
		specialization_magical = 1
	}

	project_output = {
		country_effects = {
			custom_effect_tooltip = {
				localization_key = SP_UNLOCK_TECH
				TECH = tech_magical_supply_organisation
			}
			set_technology = {
				tech_magical_supply_organisation = 1
				popup = no
			}
			mark_technology_tree_layout_dirty = yes
		}
	}

	generic_prototype_rewards = {
		### need to add xp & breakthrough rewards
	}

	unique_prototype_rewards = {

		sp_magical_supply_organisation_choice_reward = {
			fire_only_once = yes

			threshold = { 
				min = 35
				max = 50
			}

			weight = {
				
			}

			option = { ## Supply Node Range
				token = sp_magical_supply_organisation_supply_node_choice

				iteration_output = {
					country_effects = {
						custom_effect_tooltip = {
							localization_key = SP_UNLOCK_TECH
							TECH = tech_magical_supply_organisation_supply_node_range
						}
						set_technology = {
							tech_magical_supply_organisation_supply_node_range = 1
							popup = no
						}
						mark_technology_tree_layout_dirty = yes						
					}
				}
			}

			option = { ## General Supply Grace
				token = sp_magical_supply_organisation_supply_grace_choice

				iteration_output = {
					country_effects = {
						custom_effect_tooltip = {
							localization_key = SP_UNLOCK_TECH
							TECH = tech_magical_depot_organisation_supply_grace
						}
						set_technology = {
							tech_magical_depot_organisation_supply_grace = 1
							popup = no
						}
						mark_technology_tree_layout_dirty = yes
						
					}
				}
			}

			option = { ## Special Forces Supply Grace
				token = sp_magical_supply_organisation_special_forces_supply_grace_choice

				iteration_output = {
					country_effects = {
						custom_effect_tooltip = {
							localization_key = SP_UNLOCK_TECH
							TECH = tech_magical_depot_organisation_sf_supply_grace
						}
						set_technology = {
							tech_magical_depot_organisation_sf_supply_grace = 1
							popup = no
						}
						mark_technology_tree_layout_dirty = yes						
					}
				}
			}

		}

	}
}

sp_magical_imperceptibility_studies = { ## Magical Imperceptibility Studies
	specialization = specialization_magical
	icon = GFX_sp_magical_interceptability_studies


	allowed = {
		has_dlc = "La Resistance"		
	}

	project_tags = {
		sp_tag_magical
	}

	resource_cost = {
		resources = { 
			crystals = 3
		 }
	}

	available = {
		FROM = {
			has_intelligence_agency = yes
		}
	}

	ai_will_do = {
		base = 1
	}

	complexity = sp_complexity.medium
	prototype_time = sp_time.prototype.medium
	breakthrough_cost = {
		specialization_magical = 1
	}

	project_output = {
		country_effects = {
			custom_effect_tooltip = {
				localization_key = SP_UNLOCK_TECH
				TECH = tech_magical_imperceptibility_studies
			}
			set_technology = {
				tech_magical_imperceptibility_studies = 1
				popup = no
			}
			mark_technology_tree_layout_dirty = yes
		}
	}

	generic_prototype_rewards = {
		### need to add xp & breakthrough rewards
	}

	unique_prototype_rewards = {

		sp_magical_interceptability_studies_choice_reward = {
			fire_only_once = yes

			threshold = { 
				min = 35
				max = 50
			}

			weight = {
				
			}

			option = { ## Offensive spying focus
				token = sp_magical_interceptability_studies_offensive_choice

				iteration_output = {
					country_effects = {
						custom_effect_tooltip = {
							localization_key = SP_UNLOCK_TECH
							TECH = tech_magical_imperceptibility_studies_offensive
						}
						set_technology = {
							tech_magical_imperceptibility_studies_offensive = 1
							popup = no
						}
						mark_technology_tree_layout_dirty = yes
						
					}
				}
			}

			option = { ## Defensive spying focus
				token = sp_magical_interceptability_studies_defensive_choice

				iteration_output = {
					country_effects = {
						custom_effect_tooltip = {
							localization_key = SP_UNLOCK_TECH
							TECH = tech_magical_imperceptibility_studies_defensive
						}
						set_technology = {
							tech_magical_imperceptibility_studies_defensive = 1
							popup = no
						}
						mark_technology_tree_layout_dirty = yes
						
					}
				}
			}

		}

	}
}

sp_magical_thaumaturgical_encryption_keys = { ## Thaumaturgical Encryption Keys
	specialization = specialization_magical
	icon = GFX_sp_magical_thaumaturgical_encryption_keys

	allowed = {
		has_dlc = "La Resistance"		
	}

	project_tags = {
		sp_tag_magical
	}

	resource_cost = {
		resources = { 
			crystals = 3
		 }
	}

	available = {
		FROM = {
			has_intelligence_agency = yes
			has_done_agency_upgrade = upgrade_form_department
		}
	}
	

	ai_will_do = {
		base = 1
	}

	complexity = sp_complexity.medium
	prototype_time = sp_time.prototype.medium
	breakthrough_cost = {
		specialization_magical = 1
	}

	project_output = {
		country_effects = {
			custom_effect_tooltip = {
				localization_key = SP_UNLOCK_TECH
				TECH = tech_magical_thaumaturgical_encryption_keys
			}
			set_technology = {
				tech_magical_thaumaturgical_encryption_keys = 1
				popup = no
			}
			mark_technology_tree_layout_dirty = yes
			gain_random_agency_upgrade = yes
			gain_random_agency_upgrade = yes
		}
	}

	generic_prototype_rewards = {
		### need to add xp & breakthrough rewards
	}

	unique_prototype_rewards = {

		sp_magical_thaumaturgical_encryption_keys_choice_reward = {
			fire_only_once = yes

			threshold = { 
				min = 35
				max = 50
			}

			weight = {
				
			}

			option = { ## Refocus on decryption  
				token = sp_magical_thaumaturgical_encryption_keys_decryption_choice

				iteration_output = {
					country_effects = {
						custom_effect_tooltip = {
							localization_key = SP_UNLOCK_TECH
							TECH = tech_magical_thaumaturgical_encryption_keys_decryption
						}
						set_technology = {
							tech_magical_thaumaturgical_encryption_keys_decryption = 1
							popup = no
						}
						
					}
				}
			}

			option = { ## Maintain focus on encryption
				token = sp_magical_thaumaturgical_encryption_keys_encryption_choice

				iteration_output = {
					country_effects = {
						custom_effect_tooltip = {
							localization_key = SP_UNLOCK_TECH
							TECH = tech_magical_thaumaturgical_encryption_keys_encryption
						}
						set_technology = {
							tech_magical_thaumaturgical_encryption_keys_encryption = 1
							popup = no
						}
						
					}
				}
			}

		}

	}
}

sp_magical_force_multiplication = { ## Magical Force Multiplication
	specialization = specialization_magical
	icon = GFX_sp_magical_force_multiplication

	project_tags = {
		sp_tag_magical
	}

	resource_cost = {
		resources = { 
			crystals = 3
		 }
	}

	available = {
		FROM = {
			OR = {
				has_tech = marines
				has_tech = tech_mountaineers
				has_tech = paratroopers
				has_tech = tech_pegasi
				has_tech = tech_knights
				has_tech = tech_jager
				has_tech = tech_spirit_warriors
			}
			has_tech = magical_weapons1
		}
	}

	special_project_parent = {
		sp_land_military_engineering_vehicles
	}
	

	ai_will_do = {
		base = 1
	}

	complexity = sp_complexity.medium
	prototype_time = sp_time.prototype.medium
	breakthrough_cost = {
		specialization_magical = 1
	}


	project_output = {

		enable_subunits = {
			magical_shock_company
		}

		country_effects = {
			custom_effect_tooltip = {
				localization_key = SP_UNLOCK_TECH
				TECH = tech_magical_shock_company
			}
			set_technology = {
				tech_magical_shock_company = 1
				popup = no
			}
			mark_technology_tree_layout_dirty = yes
		}
	}

	generic_prototype_rewards = {
		### need to add xp & breakthrough rewards
	}

	unique_prototype_rewards = {

		sp_magical_force_multiplication_choice_reward = {
			fire_only_once = yes

			threshold = { 
				min = 35
				max = 50
			}

			weight = {
				
			}

			option = { ## make ASVs cheaper
				token = sp_magical_force_multiplication_cheaper_ASV_choice

				iteration_output = {
					equipment_bonus = {
						armored_support_vehicle = {
							build_cost_ic = -0.15
						}
					}
					
				}
			}

			option = { ## Piercing boost
				token = sp_magical_force_multiplication_piercing_choice

				iteration_output = {
					sub_unit_bonus = {
						magical_shock_company = {
							ap_attack = 2
						}
					}
					
				}
			}

			option = { ## Organisation boost
				token = sp_magical_force_multiplication_organisation_choice

				iteration_output = {
					sub_unit_bonus = {
						magical_shock_company = {
							max_organisation = 5
						}
					}
					
				}
			}

		}

	}
}

sp_magical_synthetic_mineral_growth = { ## Synthetic Mineral Growth
	specialization = specialization_magical
	icon = GFX_sp_magical_synthetic_mineral_growth

	project_tags = {
		sp_tag_magical
	}

	resource_cost = {
		resources = { 
			crystals = 3
		 }
	}

	available = {
		FROM = {
			has_tech = synth_oil_experiments
			has_tech = magical_weapons1
		}
	}

	ai_will_do = {
		base = 1
	}

	complexity = sp_complexity.medium
	prototype_time = sp_time.prototype.medium
	breakthrough_cost = {
		specialization_magical = 1
	}


	project_output = {

		country_effects = {			
			custom_override_tooltip = {
				tooltip = {
					localization_key = SP_UNLOCK_BUILDING_ICON_DESC
					BUILDING = synthetic_crystal_refinery
					BUILDING_DESCRIPTION = synthetic_crystal_refinery_desc
					ICON_FRAME = 30
				}
				set_technology = {
					tech_synthetic_crystal_refinery = 1
					popup = no
				}
			}
			mark_technology_tree_layout_dirty = yes
		}
	}

	generic_prototype_rewards = {
		### need to add xp & breakthrough rewards
	}
}

sp_magical_thaumaturgical_diagnoses = { ## Thaumaturgical Diagnoses
	specialization = specialization_magical
	icon = GFX_sp_magical_thaumaturgical_diagnoses

	project_tags = {
		sp_tag_magical
	}

	resource_cost = {
		resources = { 
			crystals = 3
		 }
	}

	available = {
		FROM = {
			has_tech = tech_field_hospital
			has_tech = magical_weapons1
		}
	}

	ai_will_do = {
		base = 1
	}

	complexity = sp_complexity.medium
	prototype_time = sp_time.prototype.medium
	breakthrough_cost = {
		specialization_magical = 1
	}


	project_output = {

		country_effects = {
			add_tech_bonus = {
				name = sp_rockets_high_speed_flight_control_bonus
				bonus = 1.5
				uses = 1
				ahead_reduction = 2
				category = hospital_tech
			}
			add_timed_idea = {
				idea = sp_thaumaturgical_diagnoses
				days = 210
			}
		}
	}

	generic_prototype_rewards = {
		### need to add xp & breakthrough rewards
	}

	unique_prototype_rewards = {

		sp_magical_thaumaturgical_diagnoses_choice_reward = {
			fire_only_once = yes

			threshold = { 
				min = 35
				max = 50
			}

			weight = {
				
			}

			option = { ## population growth boost
				token = sp_magical_thaumaturgical_diagnoses_cheaper_pop_growth_choice

				iteration_output = {
					country_effects = {
						custom_effect_tooltip = {
							localization_key = SP_UNLOCK_TECH
							TECH = tech_magical_thaumaturgical_diagnoses_pop_growth
						}
						set_technology = {
							tech_magical_thaumaturgical_diagnoses_pop_growth = 1
							popup = no
						}
						mark_technology_tree_layout_dirty = yes
					}
				}
			}

			option = { ## hospital unit boost
				token = sp_magical_thaumaturgical_diagnoses_hospital_unit_choice

				iteration_output = {
					sub_unit_bonus = {
						field_hospital = {
							casualty_trickleback = 0.05
							experience_loss_factor = -0.05
						}
					}
				}
			}

			option = { ## battalion modifier boost
				token = sp_magical_thaumaturgical_diagnoses_organisation_choice

				iteration_output = {
					sub_unit_bonus = {
						field_hospital = {
							battalion_mult = {
								category = category_all_infantry
								max_strength = 0.05
							}
						}
					}
				}
			}

		}

	}
}

sp_magical_earth_shatter_crystal_projectiles = { ## Energy Shatter Crystal Projectiles
	specialization = specialization_magical
	icon = GFX_sp_magical_earth_shatter_crystal_projectiles

	project_tags = {
		sp_tag_magical
	}

	resource_cost = {
		resources = { 
			crystals = 3
		 }
	}

	available = {
		FROM = {
			has_tech = magical_weapons2
		}
	}

	ai_will_do = {
		base = 1
	}

	complexity = sp_complexity.medium
	prototype_time = sp_time.prototype.medium
	breakthrough_cost = {
		specialization_magical = 1
	}


	project_output = {

		country_effects = {
			### add modifier/tech for non-DLC owners
		}

		enable_equipment_modules = {
			### add modules
		}
	}

	generic_prototype_rewards = {
		### need to add xp & breakthrough rewards
	}
}

#########################
#########################

  ###   ##  #   # #   #
 #   # #  # ##  #  # #
 ####  #  # # # #   #
 #     #  # #  ##   #
 #      ##  #   #   #

#########################
#########################


####################################
####################################

  ###   ###  # #### #### ##  #   #
 #      #  # # #    #   #  # ##  #
 #  ##  ###  # ###  ### #  # # # #
 #   #  # #  # #    #   #  # #  ##
  ###   #  # # #    #    ##  #   #

####################################
####################################


#######################
#######################

 ###   #### #### ###  
 #   # #    #    #  # 
 #   # ###  ###  ###  
 #   # #    #    # #  
 ###   #### #### #  # 

#######################
#######################


######################################################
######################################################

  ###  #  #  ##  #   #  ###  #### #    # #   #  ###
 #     #  # #  # ##  # #     #    #    # ##  # #
 #  ## #### #### # # # #  ## ###  #    # # # # #  ##
 #   # #  # #  # #  ## #   # #    #    # #  ## #   #
  ###  #  # #  # #   #  ###  #### #### # #   #  ###

######################################################
######################################################


##################
##################

 #   #  ##  #  #
  # #  #  # # #
   #   #### ##
   #   #  # # #
   #   #  # #  #

##################
##################


##############################################
##############################################

 #  # # ###  ###   ##   ###  ###  # #### ####
 #  # # #  # #  # #  # #     #  # # #    #
 #### # ###  ###  #  # #  ## ###  # ###  ###
 #  # # #    #    #  # #   # # #  # #    #
 #  # # #    #     ##   ###  #  # # #    #

##############################################
##############################################