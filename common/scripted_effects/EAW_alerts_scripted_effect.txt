# Scripted effects for custom alert system

# eaw_initialize_alerts = {
# 	clear_array = eaw_alerts
# 	clear_array = eaw_alert_color

# 	add_to_array = { eaw_alerts = 0 }
# 	resize_array = { array = eaw_alerts size = 1 value = 0 }
# 	resize_array = { array = eaw_alert_color size = 1 value = 0 }
	
# 	eaw_alert_update_gui = yes
# }

add_eaw_alert_unless_exists = {
	if = {
		limit = {
			NOT = { is_in_array = { eaw_alerts = alert_id } }
		}

		add_eaw_alert = yes
	}
}

# Adds an alert with id `alert_id` and data `alert_data` to the list of alerts unconditionally
add_eaw_alert = {
	add_to_array = { array = eaw_alerts value = alert_id index = 0 }
	add_to_array = { array = eaw_alert_color value = alert_color index = 0 }

	# sound_effect = "crabrave"
	
	eaw_alert_update_gui = yes
}

# Removes all alerts with id `alert_id`
remove_eaw_alert = {
	set_temp_variable = { idx = 0 }

	while_loop_effect = {
		limit = { check_variable = { idx < eaw_alerts^num } }

		if = { 
			limit = { check_variable = { eaw_alerts^idx = alert_id } }

			remove_from_array = { array = eaw_alerts index = idx }
			remove_from_array = { array = eaw_alert_color index = idx }

			subtract_from_temp_variable = { idx = 1 }
		}
		add_to_temp_variable = { idx = 1 }
	}
	
	eaw_alert_update_gui = yes
}

# Alert click effect
eaw_alert_click = {
	
	
	eaw_alert_update_gui = yes
}

# Alert cancel effect
eaw_alert_right_click = {
	remove_from_array = { array = eaw_alerts index = alert_idx }
	remove_from_array = { array = eaw_alert_color index = alert_idx }
	eaw_alert_update_gui = yes
}

eaw_alert_update_gui = {
	if = {
		limit = {
			is_ai = no
		}
		add_to_variable = { eaw_alertbar_dirty = 0.001 }
	}
}