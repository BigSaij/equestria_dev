#########
# DEBUG #
#########
d_add_h = {
	add_to_array = { level_1_hchs_array = 11.001 }
}


#########################
# GENERAL VALUE EFFECTS #
#########################
# get the id from a hch value
kir_get_hch_id_from_value_effect = {
	# hch_value -- temp variable to get id from
	# hch_id -- output temp var

	# get const value
	set_temp_variable = { hch_slot = hch_value }
	round_temp_variable = hch_slot  # round to get only slot

	# subtract const from value to get id
	set_temp_variable = { hch_id = hch_value }
	subtract_from_temp_variable = { hch_id = hch_slot }
}

# get the level from a hch value
kir_get_hch_level_from_value_effect = {
	# hch_value -- temp variable to get id from
	# hch_level -- output temp var

	# get level value
	set_temp_variable = { hch_level = hch_value }  # get value
	divide_temp_variable = { hch_level = 10 }  # move the coma one space
	round_temp_variable = hch_level  # round to get only level
}

# get the slot number from a hch value
kir_get_hch_slot_from_value_effect = {
	# hch_value -- temp variable to get id from
	# hch_slot -- output temp var

	# get rounded value
	set_temp_variable = { hch_rounded = hch_value }  # get value
	round_temp_variable = hch_rounded  # round

	# get level times 10
	kir_get_hch_level_from_value_effect = yes
	set_temp_variable = { hch_level_10 = hch_level }
	multiply_temp_variable = { hch_level_10 = 10 }

	# subtract to get slot
	set_temp_variable = { hch_slot = hch_rounded }
	subtract_from_temp_variable = { hch_slot = hch_level_10 }
}

###################
# ARRAY MANAGMENT #
###################
# setup of the arrays
kir_hch_setup_arrays_effect = {
	# array with all characters
	add_to_array = { all_hchs_array = 0.001 }
	add_to_array = { all_hchs_array = 0.002 }
	add_to_array = { all_hchs_array = 0.003 }
	# add_to_array = { all_hchs_array = 0.004 }
	# add_to_array = { all_hchs_array = 0.005 }
	# add_to_array = { all_hchs_array = 0.006 }

	## level arrays
	# level 1
	add_to_array = { level_1_hchs_array = 10.000 }
	# level 2
	add_to_array = { level_2_hchs_array = 20.000 }
	add_to_array = { level_2_hchs_array = 21.000 }
	# level 3
	add_to_array = { level_3_hchs_array = 30.000 }
	add_to_array = { level_3_hchs_array = 31.000 }
	add_to_array = { level_3_hchs_array = 32.000 }
	# level 4
	add_to_array = { level_4_hchs_array = 40.000 }
	add_to_array = { level_4_hchs_array = 41.000 }
	add_to_array = { level_4_hchs_array = 42.000 }
	# level 5
	add_to_array = { level_5_hchs_array = 50.000 }
	add_to_array = { level_5_hchs_array = 51.000 }
	add_to_array = { level_5_hchs_array = 52.000 }
}

# effect to breat out of a loop
break = {
	set_temp_variable = { break = 1 }
}


###############
# GUI EFFECTS #
###############
# effect to setup needed vars when selecting a hch
kir_select_hch_var_setup_effect = {
	# set the selected value
	set_variable = { selected_hch_value = hch_value }

	# set id
	kir_get_hch_id_from_value_effect = yes
	set_variable = { selected_hch_id = hch_id }

	# set slot
	kir_get_hch_slot_from_value_effect = yes
	set_variable = { selected_hch_slot = hch_slot }

	# set level
	kir_get_hch_level_from_value_effect = yes
	set_variable = { selected_hch_level = hch_level }
}

# clear selection
kir_clear_selection_effect = {
	clear_variable = selected_hch_value
	clear_variable = selected_hch_id
	clear_variable = selected_hch_slot
	clear_variable = selected_hch_level
}

# effect does the same as select, but for the second slot
kir_move_select_hch_var_setup_effect = {
	# set the selected value
	set_variable = { move_hch_value = hch_value }

	# set id
	kir_get_hch_id_from_value_effect = yes
	set_variable = { move_hch_id = hch_id }

	# set slot
	kir_get_hch_slot_from_value_effect = yes
	set_variable = { move_hch_slot = hch_slot }

	# set level
	kir_get_hch_level_from_value_effect = yes
	set_variable = { move_hch_level = hch_level }
}

# clean up vars used for moving
kir_clear_move_selection_effect = {
	clear_variable = move_hch_value
	clear_variable = move_hch_id
	clear_variable = move_hch_slot
	clear_variable = move_hch_level
}

# move selected hch to move-selected hch
move_hch_effect = {
	# remove the selected hch from its slote
	meta_effect = {
		text = {
			set_temp_variable = { rounded_hch_value = selected_hch_value }
			round_temp_variable = rounded_hch_value
			set_variable = { level_[HCH_LEVEL_TXT]_hchs_array^selected_hch_slot = rounded_hch_value }
		}
		HCH_LEVEL_TXT = "[?selected_hch_level|0]"
	}

	# add the selected hch to new slot
	meta_effect = {
		text = {
			add_to_variable = { level_[HCH_LEVEL_TXT]_hchs_array^move_hch_slot = selected_hch_id }
		}
		HCH_LEVEL_TXT = "[?move_hch_level|0]"
	}

	# ideas managment
	remove_hch_id_idea_effect = yes
	add_hch_id_ideas_effect = yes
}

# remove the ideas of character of hch_id
remove_hch_id_idea_effect = {
	set_temp_variable = { selected_hch_id_1000 = selected_hch_id }
	multiply_temp_variable = { selected_hch_id_1000 = 1000 }
	meta_effect = {
		text = {
			remove_ideas = {
				hch_[HCH_ID_TXT]_level_[HCH_LEVEL_TXT]_idea
			}
		}
		HCH_ID_TXT = "[?selected_hch_id_1000]"
		HCH_LEVEL_TXT = "[?selected_hch_level]"
	}
}

# add the idea of character moving
add_hch_id_ideas_effect = {
	set_temp_variable = { selected_hch_id_1000 = selected_hch_id }
	multiply_temp_variable = { selected_hch_id_1000 = 1000 }
	meta_effect = {
		text = {
			add_ideas = {
				hch_[HCH_ID_TXT]_level_[HCH_LEVEL_TXT]_idea
			}
		}
		HCH_ID_TXT = "[?selected_hch_id_1000|0]"
		HCH_LEVEL_TXT = "[?move_hch_level|0]"
	}
}

# remove the moved character from stored characters
remove_hch_from_selection_effect = {
	remove_from_array = {
		array = all_hchs_array
		value = selected_hch_value
	}
}

add_hch_to_selection_effect = {
	add_to_array = {
		array = all_hchs_array
		value = selected_hch_value
	}
}

kir_hch_deduct_pp = {
	if = {
		limit = {
			check_variable = { selected_hch_level = 1 }
		}
		add_political_power = -50
	}
	else_if = {
		limit = {
			check_variable = { selected_hch_level = 2 }
		}
		add_political_power = -25
	}
	else_if = {
		limit = {
			OR = {
				check_variable = { selected_hch_level = 3 }
				check_variable = { selected_hch_level = 4 }
				check_variable = { selected_hch_level = 5 }
			}
		}
		add_political_power = -10
	}
}