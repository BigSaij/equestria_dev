KIR_KIS_transfer_civil_war_provinces = {
	KIS = {
		set_province_controller = 20525 
		set_province_controller = 20549 
		set_province_controller = 20649 
		set_province_controller = 20531 
		set_province_controller = 20530 
		set_province_controller = 20540 
		set_province_controller = 20551 
		set_province_controller = 20527 
		set_province_controller = 20648 
		set_province_controller = 20541 
		set_province_controller = 20545 
		set_province_controller = 20547 
		set_province_controller = 20550 
		set_province_controller = 20560 
		set_province_controller = 20561 
		set_province_controller = 20572 
		set_province_controller = 20542
	}
	KIC = {
		set_province_controller = 16721
		set_province_controller = 20619
	}
	KIR = {
		set_province_controller = 19200
		set_province_controller = 20362
		set_province_controller = 20347
		set_province_controller = 20365
		set_province_controller = 20392
		set_province_controller = 13134
		set_province_controller = 13057
		set_province_controller = 13043
		set_province_controller = 20639
		set_province_controller = 12268
		set_province_controller = 10319
		set_province_controller = 10206
	}
}

KIR_diary_SG_RESET_ENTRY_FRAMES = {
	set_variable = { KIR_diary_SG_protag_1_entry_1_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_1_entry_2_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_1_entry_3_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_1_entry_4_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_1_entry_5_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_1_entry_6_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_1_entry_7_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_1_entry_8_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_1_entry_9_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_1_entry_10_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_1_entry_11_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_1_entry_12_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_2_entry_1_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_2_entry_2_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_2_entry_3_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_2_entry_4_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_2_entry_5_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_2_entry_6_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_2_entry_7_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_2_entry_8_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_2_entry_9_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_2_entry_10_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_2_entry_11_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_2_entry_12_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_3_entry_1_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_3_entry_2_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_3_entry_3_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_3_entry_4_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_3_entry_5_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_3_entry_6_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_3_entry_7_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_3_entry_8_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_3_entry_9_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_3_entry_10_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_3_entry_11_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_3_entry_12_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_3_entry_13_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_4_entry_1_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_4_entry_2_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_4_entry_3_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_4_entry_4_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_4_entry_5_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_4_entry_6_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_4_entry_7_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_4_entry_8_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_4_entry_9_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_4_entry_10_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_4_entry_11_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_4_entry_12_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_4_entry_13_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_4_entry_14_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_4_entry_15_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_5_entry_1_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_5_entry_2_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_5_entry_3_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_5_entry_4_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_5_entry_5_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_5_entry_6_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_5_entry_7_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_5_entry_8_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_5_entry_9_button_frame = 1 }
	set_variable = { KIR_diary_SG_protag_5_entry_10_button_frame = 1 }
}

KIR_diary_SG_RESET_FRAMES = {
	set_variable = {
		protagonist_1_frame = 2
	}
	set_variable = {
		protagonist_2_frame = 2
	}
	set_variable = {
		protagonist_3_frame = 2
	}
	set_variable = {
		protagonist_4_frame = 2
	}
	set_variable = {
		protagonist_5_frame = 2
	}
	KIR_diary_SG_RESET_ENTRY_FRAMES = YES
}

KIR_unlock_entry_effect = {
	if = {
		limit = {
			has_country_flag = KIR_diary_SG_popup_toggle_YES
		}
		set_country_flag = KIR_toggled_diary_SG
		KIR_diary_SG_RESET_FRAMES = yes
		set_variable = { protagonist_1_frame = 1 }
	}
	else = {
		clr_country_flag = KIR_diary_SG_clicked_flag
		add_to_variable = { KIR_diary_SG_new_entry_var = 1 }
	}
	add_to_variable = { KIR_diary_SG_DIRTY = 1 }
}

KIR_diary_SG_protag_1_button_click_effect = {
	KIR_diary_SG_RESET_FRAMES = yes
	set_variable = { protagonist_1_frame = 1 }
	set_variable = { KIR_diary_SG_entry_var = 0 }
	add_to_variable = { KIR_diary_SG_DIRTY = 1 }
}

KIR_diary_SG_protag_2_button_click_effect = {
	KIR_diary_SG_RESET_FRAMES = yes
	set_variable = { protagonist_2_frame = 1 }
	set_variable = { KIR_diary_SG_entry_var = 0 }
	add_to_variable = { KIR_diary_SG_DIRTY = 1 }
}

KIR_diary_SG_protag_3_button_click_effect = {
	KIR_diary_SG_RESET_FRAMES = yes
	set_variable = { protagonist_3_frame = 1 }
	set_variable = { KIR_diary_SG_entry_var = 0 }
	add_to_variable = { KIR_diary_SG_DIRTY = 1 }
}

KIR_diary_SG_protag_4_button_click_effect = {
	KIR_diary_SG_RESET_FRAMES = yes
	set_variable = { protagonist_4_frame = 1 }
	set_variable = { KIR_diary_SG_entry_var = 0 }
	add_to_variable = { KIR_diary_SG_DIRTY = 1 }
}

KIR_diary_SG_protag_5_button_click_effect = {
	KIR_diary_SG_RESET_FRAMES = yes
	set_variable = { protagonist_5_frame = 1 }
	set_variable = { KIR_diary_SG_entry_var = 0 }
	add_to_variable = { KIR_diary_SG_DIRTY = 1 }
}

KIR_civil_war_transfer_diary_variables_effect = {
	set_variable = { KIR_diary_SG_protag_1_button_var = KIR.KIR_diary_SG_protag_1_button_var }
	set_variable = { KIR_diary_SG_protag_2_button_var = KIR.KIR_diary_SG_protag_2_button_var }
	set_variable = { KIR_diary_SG_protag_3_button_var = KIR.KIR_diary_SG_protag_3_button_var }
	set_variable = { KIR_diary_SG_protag_4_button_var = KIR.KIR_diary_SG_protag_4_button_var }
	set_variable = { KIRDiary1Entry1TitleVar = KIR.KIRDiary1Entry1TitleVar }
	set_variable = { KIR_diary_SG_protag_1_entry_1_var = KIR.KIR_diary_SG_protag_1_entry_1_var }
	set_variable = { KIRDiary1Entry2TitleVar = KIR.KIRDiary1Entry2TitleVar }
	set_variable = { KIR_diary_SG_protag_1_entry_2_var = KIR.KIR_diary_SG_protag_1_entry_2_var }
	set_variable = { KIRDiary1Entry3TitleVar = KIR.KIRDiary1Entry3TitleVar }
	set_variable = { KIR_diary_SG_protag_1_entry_3_var = KIR.KIR_diary_SG_protag_1_entry_3_var }
	set_variable = { KIRDiary2Entry1TitleVar = KIR.KIRDiary2Entry1TitleVar }
	set_variable = { KIR_diary_SG_protag_2_entry_1_var = KIR.KIR_diary_SG_protag_2_entry_1_var }
	set_variable = { KIRDiary2Entry2TitleVar = KIR.KIRDiary2Entry2TitleVar }
	set_variable = { KIR_diary_SG_protag_2_entry_2_var = KIR.KIR_diary_SG_protag_2_entry_2_var }
	set_variable = { KIRDiary2Entry3TitleVar = KIR.KIRDiary2Entry3TitleVar }
	set_variable = { KIR_diary_SG_protag_2_entry_3_var = KIR.KIR_diary_SG_protag_2_entry_3_var }
	set_variable = { KIRDiary3Entry1TitleVar = KIR.KIRDiary3Entry1TitleVar }
	set_variable = { KIR_diary_SG_protag_3_entry_1_var = KIR.KIR_diary_SG_protag_3_entry_1_var }
	set_variable = { KIRDiary3Entry2TitleVar = KIR.KIRDiary3Entry2TitleVar }
	set_variable = { KIR_diary_SG_protag_3_entry_2_var = KIR.KIR_diary_SG_protag_3_entry_2_var }
	set_variable = { KIRDiary3Entry3TitleVar = KIR.KIRDiary3Entry3TitleVar }
	set_variable = { KIR_diary_SG_protag_3_entry_3_var = KIR.KIR_diary_SG_protag_3_entry_3_var }
	set_variable = { KIRDiary4Entry1TitleVar = KIR.KIRDiary4Entry1TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_1_var = KIR.KIR_diary_SG_protag_4_entry_1_var }
	set_variable = { KIRDiary4Entry2TitleVar = KIR.KIRDiary4Entry2TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_2_var = KIR.KIR_diary_SG_protag_4_entry_2_var }
	set_variable = { KIRDiary4Entry3TitleVar = KIR.KIRDiary4Entry3TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_3_var = KIR.KIR_diary_SG_protag_4_entry_3_var }
}

CFR_steal_diary_KIR = {
	set_country_flag = KIR_diary_SG_protag_2_UNAVAILABLE_flag
	set_country_flag = KIR_diary_SG_protag_3_UNAVAILABLE_flag
	set_country_flag = KIR_diary_SG_protag_4_UNAVAILABLE_flag
	set_variable = { var = KIR_diary_SG_protag_1_button_offset_X value = -77 }
	set_variable = { var = KIR_diary_SG_protag_1_button_offset_Y value = 18 }
	set_variable = { KIR_diary_SG_protag_1_button_var = KIR.KIR_diary_SG_protag_1_button_var }
	set_variable = { KIRDiary1Entry1TitleVar = KIR.KIRDiary1Entry1TitleVar }
	set_variable = { KIR_diary_SG_protag_1_entry_1_var = KIR.KIR_diary_SG_protag_1_entry_1_var }
	set_variable = { KIRDiary1Entry2TitleVar = KIR.KIRDiary1Entry2TitleVar }
	set_variable = { KIR_diary_SG_protag_1_entry_2_var = KIR.KIR_diary_SG_protag_1_entry_2_var }
	set_variable = { KIRDiary1Entry3TitleVar = KIR.KIRDiary1Entry3TitleVar }
	set_variable = { KIR_diary_SG_protag_1_entry_3_var = KIR.KIR_diary_SG_protag_1_entry_3_var }
	set_variable = { KIRDiary1Entry4TitleVar = KIR.KIRDiary1Entry4TitleVar }
	set_variable = { KIR_diary_SG_protag_1_entry_4_var = KIR.KIR_diary_SG_protag_1_entry_4_var }
	set_variable = { KIRDiary1Entry5TitleVar = KIR.KIRDiary1Entry5TitleVar }
	set_variable = { KIR_diary_SG_protag_1_entry_5_var = KIR.KIR_diary_SG_protag_1_entry_5_var }
	set_variable = { KIRDiary1Entry6TitleVar = KIR.KIRDiary1Entry6TitleVar }
	set_variable = { KIR_diary_SG_protag_1_entry_6_var = KIR.KIR_diary_SG_protag_1_entry_6_var }
	set_variable = { KIRDiary1Entry7TitleVar = KIR.KIRDiary1Entry7TitleVar }
	set_variable = { KIR_diary_SG_protag_1_entry_7_var = KIR.KIR_diary_SG_protag_1_entry_7_var }
	set_variable = { KIRDiary1Entry8TitleVar = KIR.KIRDiary1Entry8TitleVar }
	set_variable = { KIR_diary_SG_protag_1_entry_8_var = KIR.KIR_diary_SG_protag_1_entry_8_var }
	set_variable = { KIRDiary1Entry9TitleVar = KIR.KIRDiary1Entry9TitleVar }
	set_variable = { KIR_diary_SG_protag_1_entry_9_var = KIR.KIR_diary_SG_protag_1_entry_9_var }
	set_variable = { KIRDiary1Entry10TitleVar = KIR.KIRDiary1Entry10TitleVar }
	set_variable = { KIR_diary_SG_protag_1_entry_10_var = KIR.KIR_diary_SG_protag_1_entry_10_var }
	set_variable = { KIRDiary1Entry11TitleVar = KIR.KIRDiary1Entry11TitleVar }
	set_variable = { KIR_diary_SG_protag_1_entry_11_var = KIR.KIR_diary_SG_protag_1_entry_11_var }
	set_variable = { KIRDiary1Entry12TitleVar = KIR.KIRDiary1Entry12TitleVar }
	set_variable = { KIR_diary_SG_protag_1_entry_12_var = KIR.KIR_diary_SG_protag_1_entry_12_var }
}

CFR_steal_diary_KIC = {
	set_country_flag = KIR_diary_SG_protag_1_UNAVAILABLE_flag
	set_country_flag = KIR_diary_SG_protag_2_UNAVAILABLE_flag
	set_country_flag = KIR_diary_SG_protag_3_UNAVAILABLE_flag
	set_variable = { var = KIR_diary_SG_protag_4_button_offset_X value = -77 }
	set_variable = { var = KIR_diary_SG_protag_4_button_offset_Y value = 18 }
	set_variable = { KIR_diary_SG_protag_4_button_var = KIC.KIR_diary_SG_protag_4_button_var }
	set_variable = { KIRDiary4Entry1TitleVar = KIC.KIRDiary4Entry1TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_1_var = KIC.KIR_diary_SG_protag_4_entry_1_var }
	set_variable = { KIRDiary4Entry2TitleVar = KIC.KIRDiary4Entry2TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_2_var = KIC.KIR_diary_SG_protag_4_entry_2_var }
	set_variable = { KIRDiary4Entry3TitleVar = KIC.KIRDiary4Entry3TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_3_var = KIC.KIR_diary_SG_protag_4_entry_3_var }
	set_variable = { KIRDiary4Entry4TitleVar = KIC.KIRDiary4Entry4TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_4_var = KIC.KIR_diary_SG_protag_4_entry_4_var }
	set_variable = { KIRDiary4Entry5TitleVar = KIC.KIRDiary4Entry5TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_5_var = KIC.KIR_diary_SG_protag_4_entry_5_var }
	set_variable = { KIRDiary4Entry6TitleVar = KIC.KIRDiary4Entry6TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_6_var = KIC.KIR_diary_SG_protag_4_entry_6_var }
	set_variable = { KIRDiary4Entry7TitleVar = KIC.KIRDiary4Entry7TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_7_var = KIC.KIR_diary_SG_protag_4_entry_7_var }
	set_variable = { KIRDiary4Entry8TitleVar = KIC.KIRDiary4Entry8TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_8_var = KIC.KIR_diary_SG_protag_4_entry_8_var }
	set_variable = { KIRDiary4Entry9TitleVar = KIC.KIRDiary4Entry9TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_9_var = KIC.KIR_diary_SG_protag_4_entry_9_var }
	set_variable = { KIRDiary4Entry10TitleVar = KIC.KIRDiary4Entry10TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_10_var = KIC.KIR_diary_SG_protag_4_entry_10_var }
	set_variable = { KIRDiary4Entry11TitleVar = KIC.KIRDiary4Entry11TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_11_var = KIC.KIR_diary_SG_protag_4_entry_11_var }
	set_variable = { KIRDiary4Entry12TitleVar = KIC.KIRDiary4Entry12TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_12_var = KIC.KIR_diary_SG_protag_4_entry_12_var }
	set_variable = { KIRDiary4Entry13TitleVar = KIC.KIRDiary4Entry13TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_13_var = KIC.KIR_diary_SG_protag_4_entry_13_var }
	set_variable = { KIRDiary4Entry14TitleVar = KIC.KIRDiary4Entry14TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_14_var = KIC.KIR_diary_SG_protag_4_entry_14_var }
	set_variable = { KIRDiary4Entry15TitleVar = KIC.KIRDiary4Entry15TitleVar }
	set_variable = { KIR_diary_SG_protag_4_entry_15_var = KIC.KIR_diary_SG_protag_4_entry_15_var }
}

KIS_treasury_figure_out_prices = {
	#############################################
	## Figure out GRI Infantry Equipment Level ##
	#############################################
	if = {
		limit = {
			GRI = {
				has_tech = infantry_weapons
			}
		}
		set_variable = { KIS_buy_guns_GRI_cost = 4500 }
	}
	if = {
		limit = {
			GRI = {
				has_tech = infantry_weapons1
			}
		}
		set_variable = { KIS_buy_guns_GRI_cost = 5000 }
	}
	if = {
		limit = {
			GRI = {
				has_tech = improved_infantry_weapons
			}
		}
		set_variable = { KIS_buy_guns_GRI_cost = 5500 }
	}
	if = {
		limit = {
			GRI = {
				has_tech = advanced_infantry_weapons
			}
		}
		set_variable = { KIS_buy_guns_GRI_cost = 6000 }
	}
	if = {
		limit = {
			GRI = {
				has_tech = advanced_infantry_weapons_b
			}
		}
		set_variable = { KIS_buy_guns_GRI_cost = 6500 }
	}
	if = {
		limit = {
			GRI = {
				has_tech = advanced_infantry_weapons_e
			}
		}
		set_variable = { KIS_buy_guns_GRI_cost = 7000 }
	}
	#############################################
	## Figure out KIS Infantry Equipment Level ##
	#############################################
	if = {
		limit = {
			KIS = {
				has_tech = infantry_weapons
			}
		}
		set_variable = { KIS_buy_guns_KIS_cost = 3500 }
	}
	if = {
		limit = {
			KIS = {
				has_tech = infantry_weapons1
			}
		}
		set_variable = { KIS_buy_guns_KIS_cost = 4000 }
	}
	if = {
		limit = {
			KIS = {
				has_tech = improved_infantry_weapons
			}
		}
		set_variable = { KIS_buy_guns_KIS_cost = 4500 }
	}
	if = {
		limit = {
			KIS = {
				has_tech = advanced_infantry_weapons
			}
		}
		set_variable = { KIS_buy_guns_KIS_cost = 5000 }
	}
	if = {
		limit = {
			KIS = {
				has_tech = advanced_infantry_weapons_b
			}
		}
		set_variable = { KIS_buy_guns_KIS_cost = 5500 }
	}
	if = {
		limit = {
			KIS = {
				has_tech = advanced_infantry_weapons_e
			}
		}
		set_variable = { KIS_buy_guns_KIS_cost = 6000 }
	}
}

KIS_plebiscite_calculate_average_popular_support = {
	set_variable = { KIS_plebiscite_average_popular_support = 0 }
	add_to_variable = { KIS_plebiscite_average_popular_support = KIS_plebiscite_fragrance_support_var }
	add_to_variable = { KIS_plebiscite_average_popular_support = KIS_plebiscite_comely_cape_support_var }
	add_to_variable = { KIS_plebiscite_average_popular_support = KIS_plebiscite_prosperous_dell_support_var }
	add_to_variable = { KIS_plebiscite_average_popular_support = KIS_plebiscite_rhapsody_support_var }
	add_to_variable = { KIS_plebiscite_average_popular_support = KIS_plebiscite_viridian_coast_support_var }
	add_to_variable = { KIS_plebiscite_average_popular_support = KIS_plebiscite_radiance_support_var }
	add_to_variable = { KIS_plebiscite_average_popular_support = KIS_plebiscite_verdant_fields_support_var }
	add_to_variable = { KIS_plebiscite_average_popular_support = KIS_plebiscite_apricot_glen_support_var }
	multiply_variable = { KIS_plebiscite_average_popular_support = 100 }
	divide_variable = { KIS_plebiscite_average_popular_support = 8 }
	clamp_variable = {
		var = KIS_plebiscite_average_popular_support
		min = 0
		max = 100
	}
}

KIS_gain_offsite_factories_wacky_trigger_one = {
	add_offsite_building = { type = industrial_complex level = 1 }
	add_offsite_building = { type = arms_factory level = 1 }
	add_offsite_building = { type = dockyard level = 1 }
}

KIS_gain_offsite_factories_wacky_trigger_two = {
	add_offsite_building = { type = industrial_complex level = -1 }
	add_offsite_building = { type = arms_factory level = -1 }
	add_offsite_building = { type = dockyard level = -1 }
}

KIR_alleviate_failed_industrialisation_idea_effect = {
	if = {
		limit = {
			has_idea = KIR_failed_industrialisation_idea
		}
		swap_ideas = { add_idea = KIR_failed_industrialisation_idea1 remove_idea = KIR_failed_industrialisation_idea }
	}
	else_if = {
		limit = {
			has_idea = KIR_failed_industrialisation_idea1
		}
		swap_ideas = { add_idea = KIR_failed_industrialisation_idea2 remove_idea = KIR_failed_industrialisation_idea1 }
	}
	else_if = {
		limit = {
			has_idea = KIR_failed_industrialisation_idea2
		}
		swap_ideas = { add_idea = KIR_failed_industrialisation_idea3 remove_idea = KIR_failed_industrialisation_idea2 }
	}
	else_if = {
		limit = {
			has_idea = KIR_failed_industrialisation_idea3
		}
		remove_ideas = KIR_failed_industrialisation_idea3
	}
	else_if = {
		limit = {
			NOT = { 
				AND = {
					has_idea = KIR_failed_industrialisation_idea
					has_idea = KIR_failed_industrialisation_idea1
					has_idea = KIR_failed_industrialisation_idea2
					has_idea = KIR_failed_industrialisation_idea3
				}
			}
		}
		add_political_power = 100
		add_tech_bonus = {
			name = industrial_bonus
			bonus = 2.0
			uses = 2
			category = industry
		}
	}
}

KIR_alleviate_civil_war_idea_effect = {
	if = {
		limit = {
			has_idea = KIR_civil_war
		}
		swap_ideas = { add_idea = KIR_civil_war1 remove_idea = KIR_civil_war }
	}
	else_if = {
		limit = {
			has_idea = KIR_civil_war1
		}
		swap_ideas = { add_idea = KIR_civil_war2 remove_idea = KIR_civil_war1 }
	}
	else_if = {
		limit = {
			has_idea = KIR_civil_war2
		}
		remove_ideas = KIR_civil_war2
	}
	else_if = {
		limit = {
			NOT = { 
				AND = {
					has_idea = KIR_civil_war
					has_idea = KIR_civil_war1
					has_idea = KIR_civil_war2
				}
			}
		}
		add_political_power = 150
		add_stability = 0.05
	}
}

KIR_upgrade_iron_order_idea_effect = {
	if = {
		limit = {
			has_idea = KIR_NAKP
		}
		swap_ideas = { add_idea = KIR_NAKP1 remove_idea = KIR_NAKP }
	}
	else_if = {
		limit = {
			has_idea = KIR_NAKP1
		}
		swap_ideas = { add_idea = KIR_NAKP2 remove_idea = KIR_NAKP1 }
	}
	else_if = {
		limit = {
			has_idea = KIR_NAKP2
		}
		swap_ideas = { add_idea = KIR_NAKP3 remove_idea = KIR_NAKP2 }
	}
	else_if = {
		limit = {
			has_idea = KIR_NAKP3
		}
		add_command_power = 25
		army_experience = 25
		if = {
			limit = {
				has_government = fascism
			}
			add_popularity = {
				ideology = fascism
				popularity = 0.05
			}
		}
		if = {
			limit = {
				has_government = neutrality
			}
			add_popularity = {
				ideology = neutrality
				popularity = 0.05
			}
		}
	}
}

KIS_state_corporate_vassal_clear_other_vassals_effect = {
	if = {
		limit = {
			THIS = {
				has_state_flag = KIS_selected_SYCEE_state_flag
			}
		}
		ROOT = {
			subtract_from_variable = { KIS_SYCEE_cost_var = 1000 }
		}
		clr_state_flag = KIS_selected_SYCEE_state_flag
		remove_dynamic_modifier = { modifier = KIS_SYCEE_state_modifier }
		set_variable = { KIS_state_corporate_vassal_GUI_selection_SYCEE_button_frame = 1 }
	}
	if = {
		limit = {
			THIS = {
				has_state_flag = KIS_selected_GUILD_state_flag
			}
		}
		ROOT = {
			subtract_from_variable = { KIS_GUILD_cost_var = 1000 }
		}
		clr_state_flag = KIS_selected_GUILD_state_flag
		remove_dynamic_modifier = { modifier = KIS_GUILD_state_modifier }
		set_variable = { KIS_state_corporate_vassal_GUI_selection_GUILD_button_frame = 1 }
	}
	if = {
		limit = {
			THIS = {
				has_state_flag = KIS_selected_SORGHUM_state_flag
			}
		}
		ROOT = {
			subtract_from_variable = { KIS_SORGHUM_cost_var = 1000 }
		}
		clr_state_flag = KIS_selected_SORGHUM_state_flag
		remove_dynamic_modifier = { modifier = KIS_SORGHUM_state_modifier }
		set_variable = { KIS_state_corporate_vassal_GUI_selection_SORGHUM_button_frame = 1 }
	}
	if = {
		limit = {
			THIS = {
				has_state_flag = KIS_selected_COLLEGIUM_state_flag
			}
		}
		ROOT = {
			subtract_from_variable = { KIS_COLLEGIUM_country_modifier_var = 0.02 }
			clamp_variable = {
				var = KIS_COLLEGIUM_country_modifier_var
				min = 0
				max = 0.2
			}
			subtract_from_variable = { KIS_COLLEGIUM_cost_var = 1000 }
		}
		clr_state_flag = KIS_selected_COLLEGIUM_state_flag
		remove_dynamic_modifier = { modifier = KIS_COLLEGIUM_state_modifier }
		set_variable = { KIS_state_corporate_vassal_GUI_selection_COLLEGIUM_button_frame = 1 }
	}
	if = {
		limit = {
			THIS = {
				has_state_flag = KIS_selected_FRAGRANCE_state_flag
			}
		}
		ROOT = {
			subtract_from_variable = { KIS_FRAGRANCE_country_modifier_var = 0.02 }
			clamp_variable = {
				var = KIS_FRAGRANCE_country_modifier_var
				min = 0
				max = 0.2
			}
			subtract_from_variable = { KIS_FRAGRANCE_cost_var = 1000 }
		}
		clr_state_flag = KIS_selected_FRAGRANCE_state_flag
		set_variable = { KIS_state_corporate_vassal_GUI_selection_FRAGRANCE_button_frame = 1 }
	}
	if = {
		limit = {
			THIS = {
				has_state_flag = KIS_selected_DREAMBOAT_state_flag
			}
		}
		ROOT = {
			subtract_from_variable = { KIS_DREAMBOAT_country_modifier_var = 0.02 }
			clamp_variable = {
				var = KIS_DREAMBOAT_country_modifier_var
				min = 0
				max = 0.2
			}
			subtract_from_variable = { KIS_DREAMBOAT_cost_var = 1000 }
		}
		clr_state_flag = KIS_selected_DREAMBOAT_state_flag
		remove_dynamic_modifier = { modifier = KIS_DREAMBOAT_state_modifier }
		set_variable = { KIS_state_corporate_vassal_GUI_selection_DREAMBOAT_button_frame = 1 }
	}
	if = {
		limit = {
			THIS = {
				has_state_flag = KIS_selected_SCARLET_state_flag
			}
		}
		ROOT = {
			subtract_from_variable = { KIS_SCARLET_country_modifier_var = 0.02 }
			clamp_variable = {
				var = KIS_SCARLET_country_modifier_var
				min = 0
				max = 0.2
			}
			subtract_from_variable = { KIS_SCARLET_cost_var = 1000 }
		}
		clr_state_flag = KIS_selected_SCARLET_state_flag
		remove_dynamic_modifier = { modifier = KIS_SCARLET_state_modifier }
		set_variable = { KIS_state_corporate_vassal_GUI_selection_SCARLET_button_frame = 1 }
	}
	if = {
		limit = {
			THIS = {
				has_state_flag = KIS_selected_WINGLUCK_state_flag
			}
		}
		ROOT = {
			add_to_variable = { KIS_WINGLUCK_country_modifier_var = 0.02 }
			clamp_variable = {
				var = KIS_WINGLUCK_country_modifier_var
				min = -0.2
				max = 0
			}
			subtract_from_variable = { KIS_WINGLUCK_cost_var = 1000 }
		}
		clr_state_flag = KIS_selected_WINGLUCK_state_flag
		remove_dynamic_modifier = { modifier = KIS_WINGLUCK_state_modifier }
		set_variable = { KIS_state_corporate_vassal_GUI_selection_WINGLUCK_button_frame = 1 }
	}
	if = {
		limit = {
			THIS = {
				has_state_flag = KIS_selected_CRANE_state_flag
			}
		}
		ROOT = {
			subtract_from_variable = { KIS_CRANE_cost_var = 1000 }
		}
		clr_state_flag = KIS_selected_CRANE_state_flag
		remove_dynamic_modifier = { modifier = KIS_CRANE_state_modifier }
		set_variable = { KIS_state_corporate_vassal_GUI_selection_CRANE_button_frame = 1 }
	}
	if = {
		limit = {
			THIS = {
				has_state_flag = KIS_selected_RHAPSODY_state_flag
			}
		}
		ROOT = {
			add_to_variable = { KIS_RHAPSODY_country_modifier_var = 0.02 }
			clamp_variable = {
				var = KIS_RHAPSODY_country_modifier_var
				min = -0.2
				max = 0
			}
			subtract_from_variable = { KIS_RHAPSODY_cost_var = 1000 }
		}
		clr_state_flag = KIS_selected_RHAPSODY_state_flag
		remove_dynamic_modifier = { modifier = KIS_RHAPSODY_state_modifier }
		set_variable = { KIS_state_corporate_vassal_GUI_selection_RHAPSODY_button_frame = 1 }
	}
	if = {
		limit = {
			THIS = {
				has_state_flag = KIS_selected_BULL_state_flag
			}
		}
		ROOT = {
			subtract_from_variable = { KIS_BULL_cost_var = 1000 }
		}
		clr_state_flag = KIS_selected_BULL_state_flag
		remove_dynamic_modifier = { modifier = KIS_BULL_state_modifier }
		set_variable = { KIS_state_corporate_vassal_GUI_selection_BULL_button_frame = 1 }
	}
	if = {
		limit = {
			THIS = {
				has_state_flag = KIS_selected_KIRIA_state_flag
			}
		}
		ROOT = {
			subtract_from_variable = { KIS_KIRIA_cost_var = 1000 }
		}
		clr_state_flag = KIS_selected_KIRIA_state_flag
		remove_dynamic_modifier = { modifier = KIS_KIRIA_state_modifier }
		remove_dynamic_modifier = { modifier = KIS_KIRIA_state_modifier_non_core }
		KIS = { remove_resource_rights = PREV }
		set_variable = { KIS_state_corporate_vassal_GUI_selection_KIRIA_button_frame = 1 }
	}
	ROOT = {
		clr_country_flag = KIS_state_corporate_vassal_GUI_selection_menu_flag
		add_to_variable = { KIS_state_corporate_vassal_SG_DIRTY = 1 }
	}
}

KIR_upgrade_rising_fire_idea_effect = {
	if = {
		limit = {
			has_idea = KIR_rising_fire
		}
		swap_ideas = { add_idea = KIR_rising_fire_1 remove_idea = KIR_rising_fire }
	}
	else_if = {
		limit = {
			has_idea = KIR_rising_fire_1
		}
		swap_ideas = { add_idea = KIR_rising_fire_2 remove_idea = KIR_rising_fire_1 }
	}
	else_if = {
		limit = {
			has_idea = KIR_rising_fire_2
			has_completed_focus = KIR_republic_focus_back_hoof
		}
		swap_ideas = { add_idea = KIR_rising_fire_def remove_idea = KIR_rising_fire_2 }
	}
	else_if = {
		limit = {
			has_idea = KIR_rising_fire_2
			has_completed_focus = KIR_republic_focus_sacred_revolution
		}
		swap_ideas = { add_idea = KIR_rising_fire_ofs remove_idea = KIR_rising_fire_2 }
	}
	else_if = {
		limit = {
			has_idea = KIR_rising_fire_def
		}
		swap_ideas = { add_idea = KIR_rising_fire_def1 remove_idea = KIR_rising_fire_def }
	}
	else_if = {
		limit = {
			has_idea = KIR_rising_fire_ofs
		}
		swap_ideas = { add_idea = KIR_rising_fire_ofs1 remove_idea = KIR_rising_fire_ofs }
	}
}

KIR_get_factory_ratio = {
	##Total Amount of Industry
	set_variable = { KIR_total_factories_count_var = KIR.num_of_civilian_factories }
	add_to_variable = { KIR_total_factories_count_var = KIR.num_of_military_factories }
	add_to_variable = { KIR_total_factories_count_var = KIR.num_of_naval_factories }
	##Lowest Common Denominator
	set_variable = { KIR_ratio_of_factories_var = KIR.num_of_naval_factories }
	##Ratio of Civilian Factories
	set_variable = { KIR_civilian_factories_ratio = KIR.num_of_civilian_factories }
	divide_variable = { KIR_civilian_factories_ratio = KIR.KIR_ratio_of_factories_var }
	##Ratio of Military Factories
	set_variable = { KIR_military_factories_ratio = KIR.num_of_military_factories }
	divide_variable = { KIR_military_factories_ratio = KIR.KIR_ratio_of_factories_var }
	##Ratio of Naval Factories
	set_variable = { KIR_naval_factories_ratio = KIR.num_of_naval_factories }
	divide_variable = { KIR_naval_factories_ratio = KIR.KIR_ratio_of_factories_var }
}

KIR_KI_RES_OUTPUT_COST_ADD = {
	if = {
		limit = {
			check_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 0 }
		}
		add_ideas = KIR_KI_RES
		custom_effect_tooltip = KIR_line_break
		add_to_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 1 }
	}
	else_if = {
		limit = {
			check_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 1 }
		}
		swap_ideas = { add_idea = KIR_KI_RES_1 remove_idea = KIR_KI_RES }
		add_to_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 1 }
	}
	else_if = {
		limit = {
			check_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 2 }
		}
		swap_ideas = { add_idea = KIR_KI_RES_2 remove_idea = KIR_KI_RES_1 }
		add_to_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 1 }
	}
	else_if = {
		limit = {
			check_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 3 }
		}
		swap_ideas = { add_idea = KIR_KI_RES_3 remove_idea = KIR_KI_RES_2 }
		add_to_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 1 }
	}
	else_if = {
		limit = {
			check_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 4 }
		}
		swap_ideas = { add_idea = KIR_KI_RES_4 remove_idea = KIR_KI_RES_3 }
		add_to_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 1 }
	}
	else_if = {
		limit = {
			check_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 5 }
		}
		custom_effect_tooltip = KIR_line_break
	}
}

KIR_KI_RES_OUTPUT_COST_SUBTRACT = {
	effect_tooltip = {
		swap_ideas = { add_idea = KIR_KI_RES remove_idea = KIR_KI_RES_1 }
	}
	hidden_effect = {
		if = {
			limit = {
				has_idea = KIR_KI_RES
			}
			remove_ideas = KIR_KI_RES
			subtract_from_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 1 }
		}
		else_if = {
			limit = {
				has_idea = KIR_KI_RES_1
			}
			swap_ideas = { add_idea = KIR_KI_RES remove_idea = KIR_KI_RES_1 }
			subtract_from_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 1 }
		}
		else_if = {
			limit = {
				has_idea = KIR_KI_RES_2
			}
			swap_ideas = { add_idea = KIR_KI_RES_1 remove_idea = KIR_KI_RES_2 }
			subtract_from_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 1 }
		}
		else_if = {
			limit = {
				has_idea = KIR_KI_RES_3
			}
			swap_ideas = { add_idea = KIR_KI_RES_2 remove_idea = KIR_KI_RES_3 }
			subtract_from_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 1 }
		}
		else_if = {
			limit = {
				has_idea = KIR_KI_RES_4
			}
			swap_ideas = { add_idea = KIR_KI_RES_3 remove_idea = KIR_KI_RES_4 }
			subtract_from_variable = { KIR.KIR_KI_RESOURCES_PRODUCED = 1 }
		}
	}
}

KIR_STATE_PALACE_BUTTON_CLICK_EFFECT = {
	if = {
		limit = {
			THIS = {
				has_state_flag = KIR_STATE_HAS_YAMEN
				OR = {
					has_state_flag = KIR_STATE_HAS_H1_YAMEN
					has_state_flag = KIR_STATE_HAS_H2_YAMEN
					has_state_flag = KIR_STATE_HAS_H3_YAMEN
					has_state_flag = KIR_STATE_HAS_N1_YAMEN
					has_state_flag = KIR_STATE_HAS_N2_YAMEN
					has_state_flag = KIR_STATE_HAS_N3_YAMEN
					has_state_flag = KIR_STATE_HAS_N4_YAMEN
					has_state_flag = KIR_STATE_HAS_N5_YAMEN
					has_state_flag = KIR_STATE_HAS_C1_YAMEN
					has_state_flag = KIR_STATE_HAS_C2_YAMEN
					has_state_flag = KIR_STATE_HAS_C3_YAMEN
				}
			}
		}
		THIS = {
			KIR_STATE_YAMEN_BUTTON_CLICK_EFFECT = yes
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_H1_PALACE }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_H1_PALACE
			set_variable = { KIR_STATE_H1_PALACE_BUTTON_FRAME = 2 }
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_H1_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_STATE_H1H2_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_political_power_gain_var = 0.1 }
			subtract_from_variable = { KIR_CONSOCSYS_democratic_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_political_power_gain = KIR_CONSOCSYS_political_power_gain_var }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_H2_PALACE }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_H2_PALACE
			set_variable = { KIR_STATE_H2_PALACE_BUTTON_FRAME = 2 }
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_H2_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_STATE_H1H2_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_command_power_gain_var = 0.1 }
			subtract_from_variable = { KIR_CONSOCSYS_democratic_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_command_power_gain = KIR_CONSOCSYS_command_power_gain_var }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_H3_PALACE }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_H3_PALACE
			set_variable = { KIR_STATE_H3_PALACE_BUTTON_FRAME = 2 }
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_H3_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_STATE_H3N1_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_consumer_goods_factor_var = 0.002 }
			subtract_from_variable = { KIR_CONSOCSYS_democratic_drift = 0.01 }
			add_to_variable = { KIR_CONSOCSYS_consumer_goods_factor = KIR_CONSOCSYS_consumer_goods_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_N1_PALACE }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_N1_PALACE
			set_variable = { KIR_STATE_N1_PALACE_BUTTON_FRAME = 2 }
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_N1_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_STATE_H3N1_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_research_speed_factor_var = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_neutrality_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_research_speed_factor = KIR_CONSOCSYS_research_speed_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_N2_PALACE }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_N2_PALACE
			set_variable = { KIR_STATE_N2_PALACE_BUTTON_FRAME = 2 }
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_N2_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_war_support_factor_var = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_fascism_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_war_support_factor = KIR_CONSOCSYS_war_support_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_N3_PALACE }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_N3_PALACE
			set_variable = { KIR_STATE_N3_PALACE_BUTTON_FRAME = 2 }
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_N3_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_STATE_N3N4_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_local_resources_factor_var = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_fascism_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_local_resources_factor = KIR_CONSOCSYS_local_resources_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_N4_PALACE }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_N4_PALACE
			set_variable = { KIR_STATE_N4_PALACE_BUTTON_FRAME = 2 }
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_N4_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_STATE_N3N4_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_production_factory_efficiency_gain_factor_var = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_fascism_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_production_factory_efficiency_gain_factor = KIR_CONSOCSYS_production_factory_efficiency_gain_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_N5_PALACE }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_N5_PALACE
			set_variable = { KIR_STATE_N5_PALACE_BUTTON_FRAME = 2 }
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_N5_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_stability_factor_var = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_neutrality_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_stability_factor = KIR_CONSOCSYS_stability_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_C1_PALACE }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_C1_PALACE
			set_variable = { KIR_STATE_C1_PALACE_BUTTON_FRAME = 2 }
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_C1_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_conscription_factor_var = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_communism_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_conscription_factor = KIR_CONSOCSYS_conscription_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_C2_PALACE }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_C2_PALACE
			set_variable = { KIR_STATE_C2_PALACE_BUTTON_FRAME = 2 }
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_C2_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_monthly_population_var = 0.05 }
			subtract_from_variable = { KIR_CONSOCSYS_communism_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_monthly_population = KIR_CONSOCSYS_monthly_population_var }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_C3_PALACE }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_C3_PALACE
			set_variable = { KIR_STATE_C3_PALACE_BUTTON_FRAME = 2 }
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_C3_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_production_speed_buildings_factor_var = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_communism_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_production_speed_buildings_factor = KIR_CONSOCSYS_production_speed_buildings_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier = 1 }
		}
	}
	THIS = {
		set_state_flag = KIR_STATE_DIET_SUSPENDED
		set_state_flag = { flag = KIR_STATE_DIET_SUSPENDED_GRACE_PERIOD days = 180 }
	}
}

KIR_STATE_YAMEN_BUTTON_CLICK_EFFECT = {
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_H1_YAMEN }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_H1_YAMEN
			set_variable = { KIR_STATE_H1_YAMEN_BUTTON_FRAME = 2 }
			KIR_STATE_YAMEN_BUTTON_CLICK_PALACE_CLEAR_EFFECT = yes
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_H1_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_STATE_H1H2_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_political_power_gain = KIR_CONSOCSYS_YAMEN_political_power_gain_var }
			subtract_from_variable = { KIR_CONSOCSYS_democratic_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_MAYORALTIES_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_H2_YAMEN }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_H2_YAMEN
			set_variable = { KIR_STATE_H2_YAMEN_BUTTON_FRAME = 2 }
			KIR_STATE_YAMEN_BUTTON_CLICK_PALACE_CLEAR_EFFECT = yes
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_H2_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_STATE_H1H2_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_command_power_gain = KIR_CONSOCSYS_YAMEN_command_power_gain_var }
			subtract_from_variable = { KIR_CONSOCSYS_democratic_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_MAYORALTIES_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_H3_YAMEN }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_H3_YAMEN
			set_variable = { KIR_STATE_H3_YAMEN_BUTTON_FRAME = 2 }
			KIR_STATE_YAMEN_BUTTON_CLICK_PALACE_CLEAR_EFFECT = yes
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_H3_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_STATE_H3N1_PALACE_NUM = 1 }
			add_to_variable = { KIR_CONSOCSYS_consumer_goods_factor = KIR_CONSOCSYS_YAMEN_consumer_goods_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_democratic_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_MAYORALTIES_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_N1_YAMEN }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_N1_YAMEN
			set_variable = { KIR_STATE_N1_YAMEN_BUTTON_FRAME = 2 }
			KIR_STATE_YAMEN_BUTTON_CLICK_PALACE_CLEAR_EFFECT = yes
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_N1_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_STATE_H3N1_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_research_speed_factor = KIR_CONSOCSYS_YAMEN_research_speed_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_neutrality_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_MAYORALTIES_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_N2_YAMEN }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_N2_YAMEN
			set_variable = { KIR_STATE_N2_YAMEN_BUTTON_FRAME = 2 }
			KIR_STATE_YAMEN_BUTTON_CLICK_PALACE_CLEAR_EFFECT = yes
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_N2_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_war_support_factor = KIR_CONSOCSYS_YAMEN_war_support_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_fascism_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_MAYORALTIES_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_N3_YAMEN }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_N3_YAMEN
			set_variable = { KIR_STATE_N3_YAMEN_BUTTON_FRAME = 2 }
			KIR_STATE_YAMEN_BUTTON_CLICK_PALACE_CLEAR_EFFECT = yes
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_N3_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_STATE_N3N4_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_local_resources_factor = KIR_CONSOCSYS_YAMEN_local_resources_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_fascism_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_MAYORALTIES_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_N4_YAMEN }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_N4_YAMEN
			set_variable = { KIR_STATE_N4_YAMEN_BUTTON_FRAME = 2 }
			KIR_STATE_YAMEN_BUTTON_CLICK_PALACE_CLEAR_EFFECT = yes
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_N4_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_STATE_N3N4_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_production_factory_efficiency_gain_factor = KIR_CONSOCSYS_YAMEN_production_factory_efficiency_gain_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_fascism_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_MAYORALTIES_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_N5_YAMEN }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_N5_YAMEN
			set_variable = { KIR_STATE_N5_YAMEN_BUTTON_FRAME = 2 }
			KIR_STATE_YAMEN_BUTTON_CLICK_PALACE_CLEAR_EFFECT = yes
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_N5_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_stability_factor = KIR_CONSOCSYS_YAMEN_stability_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_neutrality_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_MAYORALTIES_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_C1_YAMEN }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_C1_YAMEN
			set_variable = { KIR_STATE_C1_YAMEN_BUTTON_FRAME = 2 }
			KIR_STATE_YAMEN_BUTTON_CLICK_PALACE_CLEAR_EFFECT = yes
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_C1_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_conscription_factor = KIR_CONSOCSYS_YAMEN_conscription_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_communism_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_MAYORALTIES_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_C2_YAMEN }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_C2_YAMEN
			set_variable = { KIR_STATE_C2_YAMEN_BUTTON_FRAME = 2 }
			KIR_STATE_YAMEN_BUTTON_CLICK_PALACE_CLEAR_EFFECT = yes
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_C2_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_monthly_population = KIR_CONSOCSYS_YAMEN_monthly_population_var }
			subtract_from_variable = { KIR_CONSOCSYS_communism_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_MAYORALTIES_Modifier = 1 }
		}
	}
	if = {
		limit = { has_state_flag = KIR_STATE_HAS_C3_YAMEN }
		THIS = {
			clr_state_flag = KIR_STATE_HAS_C3_YAMEN
			set_variable = { KIR_STATE_C3_YAMEN_BUTTON_FRAME = 2 }
			KIR_STATE_YAMEN_BUTTON_CLICK_PALACE_CLEAR_EFFECT = yes
		}
		ROOT = {
			subtract_from_variable = { KIR_STATE_C3_PALACE_NUM = 1 }
			subtract_from_variable = { KIR_CONSOCSYS_production_speed_buildings_factor = KIR_CONSOCSYS_YAMEN_production_speed_buildings_factor_var }
			subtract_from_variable = { KIR_CONSOCSYS_communism_drift = 0.01 }
			subtract_from_variable = { KIR_CONSOCSYS_KIR_STATE_MAYORALTIES_Modifier = 1 }
		}
	}
}

KIR_STATE_YAMEN_BUTTON_CLICK_PALACE_CLEAR_EFFECT = {
	if = {
		limit = { THIS = { has_state_flag = KIR_STATE_HAS_H1_SYNERGY } }
		ROOT = {
			subtract_from_variable = { KIR_CONSOCSYS_political_power_gain = KIR_CONSOCSYS_SYNERGY_political_power_gain_var }
		}
		THIS = {
			clr_state_flag = KIR_STATE_HAS_H1_SYNERGY
		}
	}
	if = {
		limit = { THIS = { has_state_flag = KIR_STATE_HAS_H2_SYNERGY } }
		ROOT = {
			subtract_from_variable = { KIR_CONSOCSYS_command_power_gain = KIR_CONSOCSYS_SYNERGY_command_power_gain_var }
		}
		THIS = {
			clr_state_flag = KIR_STATE_HAS_H2_SYNERGY
		}
	}
	if = {
		limit = { THIS = { has_state_flag = KIR_STATE_HAS_H3_SYNERGY } }
		ROOT = {
			add_to_variable = { KIR_CONSOCSYS_consumer_goods_factor = KIR_CONSOCSYS_SYNERGY_consumer_goods_factor_var }
		}
		THIS = {
			clr_state_flag = KIR_STATE_HAS_H3_SYNERGY
		}
	}
	if = {
		limit = { THIS = { has_state_flag = KIR_STATE_HAS_N1_SYNERGY } }
		ROOT = {
			subtract_from_variable = { KIR_CONSOCSYS_research_speed_factor = KIR_CONSOCSYS_SYNERGY_research_speed_factor_var }
		}
		THIS = {
			clr_state_flag = KIR_STATE_HAS_N1_SYNERGY
		}
	}
	if = {
		limit = { THIS = { has_state_flag = KIR_STATE_HAS_N2_SYNERGY } }
		ROOT = {
			subtract_from_variable = { KIR_CONSOCSYS_war_support_factor = KIR_CONSOCSYS_SYNERGY_war_support_factor_var }
		}
		THIS = {
			clr_state_flag = KIR_STATE_HAS_N2_SYNERGY
		}
	}
	if = {
		limit = { THIS = { has_state_flag = KIR_STATE_HAS_N3_SYNERGY } }
		ROOT = {
			subtract_from_variable = { KIR_CONSOCSYS_local_resources_factor = KIR_CONSOCSYS_SYNERGY_local_resources_factor_var }
		}
		THIS = {
			clr_state_flag = KIR_STATE_HAS_N3_SYNERGY
		}
	}
	if = {
		limit = { THIS = { has_state_flag = KIR_STATE_HAS_N4_SYNERGY } }
		ROOT = {
			subtract_from_variable = { KIR_CONSOCSYS_production_factory_efficiency_gain_factor = KIR_CONSOCSYS_SYNERGY_production_factory_efficiency_gain_factor_var }
		}
		THIS = {
			clr_state_flag = KIR_STATE_HAS_N4_SYNERGY
		}
	}
	if = {
		limit = { THIS = { has_state_flag = KIR_STATE_HAS_N5_SYNERGY } }
		ROOT = {
			subtract_from_variable = { KIR_CONSOCSYS_stability_factor = KIR_CONSOCSYS_SYNERGY_stability_factor_var }
		}
		THIS = {
			clr_state_flag = KIR_STATE_HAS_N5_SYNERGY
		}
	}
	if = {
		limit = { THIS = { has_state_flag = KIR_STATE_HAS_C1_SYNERGY } }
		ROOT = {
			subtract_from_variable = { KIR_CONSOCSYS_conscription_factor = KIR_CONSOCSYS_SYNERGY_conscription_factor_var }
		}
		THIS = {
			clr_state_flag = KIR_STATE_HAS_C1_SYNERGY
		}
	}
	if = {
		limit = { THIS = { has_state_flag = KIR_STATE_HAS_C2_SYNERGY } }
		ROOT = {
			subtract_from_variable = { KIR_CONSOCSYS_monthly_population = KIR_CONSOCSYS_SYNERGY_monthly_population_var }
		}
		THIS = {
			clr_state_flag = KIR_STATE_HAS_C2_SYNERGY
		}
	}
	if = {
		limit = { THIS = { has_state_flag = KIR_STATE_HAS_C3_SYNERGY } }
		ROOT = {
			subtract_from_variable = { KIR_CONSOCSYS_production_speed_buildings_factor = KIR_CONSOCSYS_SYNERGY_production_speed_buildings_factor_var }
		}
		THIS = {
			clr_state_flag = KIR_STATE_HAS_C3_SYNERGY
		}
	}
}

KIR_STATE_YAMEN_BUTTON_CLICK_PALACE_ADD_EFFECT = {
	if = {
		limit = { 
			THIS = { 
				has_state_flag = KIR_STATE_HAS_H1_PALACE 
				OR = {
					has_state_flag = KIR_STATE_HAS_H1_YAMEN
					has_state_flag = KIR_STATE_HAS_H2_YAMEN
					has_state_flag = KIR_STATE_HAS_H3_YAMEN
					AND = {
						has_state_flag = KIR_STATE_HAS_N5_YAMEN
						KIR = { has_country_flag = KIR_YAMEN_SYNERGY_CC_flag }
					}
				}
			}
		}
		ROOT = {
			add_to_variable = { KIR_CONSOCSYS_political_power_gain = KIR_CONSOCSYS_SYNERGY_political_power_gain_var }
		}
		THIS = {
			set_state_flag = KIR_STATE_HAS_H1_SYNERGY
		}
	}
	if = {
		limit = { 
			THIS = { 
				has_state_flag = KIR_STATE_HAS_H2_PALACE 
				OR = {
					has_state_flag = KIR_STATE_HAS_H1_YAMEN
					has_state_flag = KIR_STATE_HAS_H2_YAMEN
					has_state_flag = KIR_STATE_HAS_H3_YAMEN
					has_state_flag = KIR_STATE_HAS_N5_YAMEN
				}
			}
		}
		ROOT = {
			add_to_variable = { KIR_CONSOCSYS_command_power_gain = KIR_CONSOCSYS_SYNERGY_command_power_gain_var }
		}
		THIS = {
			set_state_flag = KIR_STATE_HAS_H2_SYNERGY
		}
	}
	if = {
		limit = { 
			THIS = { 
				has_state_flag = KIR_STATE_HAS_H3_PALACE 
				OR = {
					has_state_flag = KIR_STATE_HAS_H1_YAMEN
					has_state_flag = KIR_STATE_HAS_H2_YAMEN
					has_state_flag = KIR_STATE_HAS_H3_YAMEN
					has_state_flag = KIR_STATE_HAS_N1_YAMEN
					AND = {
						OR = {
							has_state_flag = KIR_STATE_HAS_C2_YAMEN
							has_state_flag = KIR_STATE_HAS_C3_YAMEN
						}
						KIR = { has_country_flag = KIR_YAMEN_SYNERGY_LLL_flag }
					}
				}
			}
		}
		ROOT = {
			subtract_from_variable = { KIR_CONSOCSYS_consumer_goods_factor = KIR_CONSOCSYS_SYNERGY_consumer_goods_factor_var }
		}
		THIS = {
			set_state_flag = KIR_STATE_HAS_H3_SYNERGY
		}
	}
	if = {
		limit = { 
			THIS = { 
				has_state_flag = KIR_STATE_HAS_N1_PALACE 
				OR = {
					has_state_flag = KIR_STATE_HAS_H3_YAMEN
					has_state_flag = KIR_STATE_HAS_N1_YAMEN
					has_state_flag = KIR_STATE_HAS_N5_YAMEN
				}
			}
		}
		ROOT = {
			add_to_variable = { KIR_CONSOCSYS_research_speed_factor = KIR_CONSOCSYS_SYNERGY_research_speed_factor_var }
		}
		THIS = {
			set_state_flag = KIR_STATE_HAS_N1_SYNERGY
		}
	}
	if = {
		limit = { 
			THIS = { 
				has_state_flag = KIR_STATE_HAS_N2_PALACE 
				OR = {
					has_state_flag = KIR_STATE_HAS_N2_YAMEN
					has_state_flag = KIR_STATE_HAS_N3_YAMEN
					has_state_flag = KIR_STATE_HAS_N4_YAMEN
				}
			}
		}
		ROOT = {
			add_to_variable = { KIR_CONSOCSYS_war_support_factor = KIR_CONSOCSYS_SYNERGY_war_support_factor_var }
		}
		THIS = {
			set_state_flag = KIR_STATE_HAS_N2_SYNERGY
		}
	}
	if = {
		limit = { 
			THIS = { 
				has_state_flag = KIR_STATE_HAS_N3_PALACE 
				OR = {
					has_state_flag = KIR_STATE_HAS_N2_YAMEN
					has_state_flag = KIR_STATE_HAS_N3_YAMEN
					has_state_flag = KIR_STATE_HAS_N4_YAMEN
				}
			}
		}
		ROOT = {
			add_to_variable = { KIR_CONSOCSYS_local_resources_factor = KIR_CONSOCSYS_SYNERGY_local_resources_factor_var }
		}
		THIS = {
			set_state_flag = KIR_STATE_HAS_N3_SYNERGY
		}
	}
	if = {
		limit = { 
			THIS = { 
				has_state_flag = KIR_STATE_HAS_N4_PALACE 
				OR = {
					has_state_flag = KIR_STATE_HAS_N2_YAMEN
					has_state_flag = KIR_STATE_HAS_N3_YAMEN
					has_state_flag = KIR_STATE_HAS_N4_YAMEN
				}
			}
		}
		ROOT = {
			add_to_variable = { KIR_CONSOCSYS_production_factory_efficiency_gain_factor = KIR_CONSOCSYS_SYNERGY_production_factory_efficiency_gain_factor_var }
		}
		THIS = {
			set_state_flag = KIR_STATE_HAS_N4_SYNERGY
		}
	}
	if = {
		limit = { 
			THIS = { 
				has_state_flag = KIR_STATE_HAS_N5_PALACE 
				OR = {
					has_state_flag = KIR_STATE_HAS_H2_YAMEN
					has_state_flag = KIR_STATE_HAS_N1_YAMEN
					has_state_flag = KIR_STATE_HAS_N5_YAMEN
					AND = {
						has_state_flag = KIR_STATE_HAS_H1_YAMEN
						KIR = { has_country_flag = KIR_YAMEN_SYNERGY_CC_flag }
					}
				}
			}
		}
		ROOT = {
			add_to_variable = { KIR_CONSOCSYS_stability_factor = KIR_CONSOCSYS_SYNERGY_stability_factor_var }
		}
		THIS = {
			set_state_flag = KIR_STATE_HAS_N5_SYNERGY
		}
	}
	if = {
		limit = {
			THIS = { 
				has_state_flag = KIR_STATE_HAS_C1_PALACE 
				OR = {
					has_state_flag = KIR_STATE_HAS_C1_YAMEN
					has_state_flag = KIR_STATE_HAS_C2_YAMEN
					has_state_flag = KIR_STATE_HAS_C3_YAMEN
				}
			}
		}
		ROOT = {
			add_to_variable = { KIR_CONSOCSYS_conscription_factor = KIR_CONSOCSYS_SYNERGY_conscription_factor_var }
		}
		THIS = {
			set_state_flag = KIR_STATE_HAS_C1_SYNERGY
		}
	}
	if = {
		limit = {
			THIS = { 
				has_state_flag = KIR_STATE_HAS_C2_PALACE 
				OR = {
					has_state_flag = KIR_STATE_HAS_C1_YAMEN
					has_state_flag = KIR_STATE_HAS_C2_YAMEN
					has_state_flag = KIR_STATE_HAS_C3_YAMEN
					AND = {
						has_state_flag = KIR_STATE_HAS_H3_YAMEN
						KIR = { has_country_flag = KIR_YAMEN_SYNERGY_LLL_flag }
					}
				}
			}
		}
		ROOT = {
			add_to_variable = { KIR_CONSOCSYS_monthly_population = KIR_CONSOCSYS_SYNERGY_monthly_population_var }
		}
		THIS = {
			set_state_flag = KIR_STATE_HAS_C2_SYNERGY
		}
	}
	if = {
		limit = {
			THIS = { 
				has_state_flag = KIR_STATE_HAS_C3_PALACE 
				OR = {
					has_state_flag = KIR_STATE_HAS_C1_YAMEN
					has_state_flag = KIR_STATE_HAS_C2_YAMEN
					has_state_flag = KIR_STATE_HAS_C3_YAMEN
					AND = {
						has_state_flag = KIR_STATE_HAS_H3_YAMEN
						KIR = { has_country_flag = KIR_YAMEN_SYNERGY_LLL_flag }
					}
				}
			}
		}
		ROOT = {
			add_to_variable = { KIR_CONSOCSYS_production_speed_buildings_factor = KIR_CONSOCSYS_SYNERGY_production_speed_buildings_factor_var }
		}
		THIS = {
			set_state_flag = KIR_STATE_HAS_C3_SYNERGY
		}
	}
}
KIR_STATE_H1_PALACE_PP = {
	if = {
		limit = {
			THIS = {
				OR = {
					state = 1059
					state = 1064
					state = 833
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_STRONGHOLD_VAR_NEGATIVE }
	}
	else_if = {
		limit = {
			THIS = {
				OR = {
					AND = {
						KIR = { has_country_flag = KIR_national_focus_title_3_flag }
						state = 1088
					}
					AND = {
						KIR = { 
							has_country_flag = KIR_national_focus_title_3_flag
							NOT = { has_country_flag = KIR_NAKP_disgraced_flag }
						}
						state = 1071
					}
					state = 1087
					state = 1067
					state = 1079
					state = 926
					state = 1080
					state = 1082
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_CCH_flag }
						state = 1073
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_RHP_flag }
						state = 1060
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1069
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1076
					}
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_EXCLUDED_VAR_NEGATIVE }
	}
	else = {
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_VAR_NEGATIVE }
	}
}
KIR_STATE_H2_PALACE_PP = {
	if = {
		limit = {
			THIS = {
				OR = {
					state = 1059
					state = 1064
					state = 833
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_CCH_flag }
						state = 1073
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_RHP_flag }
						state = 1060
					}
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_STRONGHOLD_VAR_NEGATIVE }
	}
	else_if = {
		limit = {
			THIS = {
				OR = {
					AND = {
						KIR = { has_country_flag = KIR_national_focus_title_3_flag }
						state = 1088
					}
					AND = {
						KIR = { 
							has_country_flag = KIR_national_focus_title_3_flag
							NOT = { has_country_flag = KIR_NAKP_disgraced_flag }
						}
						state = 1071
					}
					state = 1087
					state = 1067
					state = 1079
					state = 926
					state = 1080
					state = 1082
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1069
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1076
					}
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_EXCLUDED_VAR_NEGATIVE }
	}
	else = {
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_VAR_NEGATIVE }
	}
}
KIR_STATE_H3_PALACE_PP = {
	if = {
		limit = {
			THIS = {
				OR = {
					state = 1064
					state = 833
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1069
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1076
					}
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_STRONGHOLD_VAR_NEGATIVE }
	}
	else_if = {
		limit = {
			THIS = {
				OR = {
					AND = {
						KIR = { has_country_flag = KIR_national_focus_title_3_flag }
						state = 1088
					}
					AND = {
						KIR = { 
							has_country_flag = KIR_national_focus_title_3_flag
							NOT = { has_country_flag = KIR_NAKP_disgraced_flag }
						}
						state = 1071
					}
					state = 1087
					state = 1067
					state = 1079
					state = 926
					state = 1080
					state = 1082
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_CCH_flag }
						state = 1073
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_RHP_flag }
						state = 1060
					}
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_EXCLUDED_VAR_NEGATIVE }
	}
	else = {
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_VAR_NEGATIVE }
	}
}
KIR_STATE_N1_PALACE_PP = {
	if = {
		limit = {
			THIS = {
				OR = {
					state = 1059
					state = 1064
					state = 833
					AND = {
						KIR = { has_country_flag = KIR_national_focus_title_3_flag }
						state = 1088
					}
					AND = {
						KIR = { 
							has_country_flag = KIR_national_focus_title_3_flag
							NOT = { has_country_flag = KIR_NAKP_disgraced_flag }
						}
						state = 1071
					}
					state = 1087
					state = 1067
					state = 1079
					state = 926
					state = 1080
					state = 1082
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_CCH_flag }
						state = 1073
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_RHP_flag }
						state = 1060
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1069
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1076
					}
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_EXCLUDED_VAR_NEGATIVE }
	}
	else = {
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_VAR_NEGATIVE }
	}
}
KIR_STATE_N2_PALACE_PP = {
	if = {
		limit = {
			THIS = {
				state = 1087
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_STRONGHOLD_VAR_NEGATIVE }
	}
	else_if = {
		limit = {
			THIS = {
				OR = {
					state = 1059
					state = 1064
					state = 833
					state = 1067
					state = 1079
					state = 926
					state = 1080
					state = 1082
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_CCH_flag }
						state = 1073
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_RHP_flag }
						state = 1060
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1069
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1076
					}
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_EXCLUDED_VAR_NEGATIVE }
	}
	else = {
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_VAR_NEGATIVE }
	}
}
KIR_STATE_N34_PALACE_PP = {
	if = {
		limit = {
			KIR = { has_country_flag = KIR_national_focus_title_3_flag }
			THIS = {
				OR = {
					AND = {
						KIR = { 
							has_country_flag = KIR_national_focus_title_3_flag
							NOT = { has_country_flag = KIR_NAKP_disgraced_flag }
						}
						state = 1071
					}
					state = 1087
					state = 1088
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_STRONGHOLD_VAR_NEGATIVE }
	}
	else_if = {
		limit = {
			THIS = {
				OR = {
					state = 1059
					state = 1064
					state = 833
					state = 1067
					state = 1079
					state = 926
					state = 1080
					state = 1082
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_CCH_flag }
						state = 1073
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_RHP_flag }
						state = 1060
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1069
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1076
					}
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_EXCLUDED_VAR_NEGATIVE }
	}
	else = {
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_VAR_NEGATIVE }
	}
}
KIR_STATE_N5_PALACE_PP = {
	if = {
		limit = {
			THIS = {
				OR = {
					state = 1067
					state = 1079
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_CCH_flag }
						state = 1073
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_RHP_flag }
						state = 1060
					}
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_STRONGHOLD_VAR_NEGATIVE }
	}
	else_if = {
		limit = {
			THIS = {
				OR = {
					state = 1059
					state = 1064
					state = 833
					state = 926
					state = 1080
					state = 1082
					AND = {
						KIR = { has_country_flag = KIR_national_focus_title_3_flag }
						state = 1088
					}
					AND = {
						KIR = { 
							has_country_flag = KIR_national_focus_title_3_flag
							NOT = { has_country_flag = KIR_NAKP_disgraced_flag }
						}
						state = 1071
					}
					state = 1087
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1069
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1076
					}
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_EXCLUDED_VAR_NEGATIVE }
	}
	else = {
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_VAR_NEGATIVE }
	}
}
KIR_STATE_C1_PALACE_PP = {
	if = {
		limit = {
			THIS = {
				OR = {
					state = 926
					state = 1080
					state = 1082
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_CCH_flag }
						state = 1073
					}
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_STRONGHOLD_VAR_NEGATIVE }
	}
	else_if = {
		limit = {
			THIS = {
				OR = {
					state = 1059
					state = 1064
					state = 833
					AND = {
						KIR = { has_country_flag = KIR_national_focus_title_3_flag }
						state = 1088
					}
					AND = {
						KIR = { 
							has_country_flag = KIR_national_focus_title_3_flag
							NOT = { has_country_flag = KIR_NAKP_disgraced_flag }
						}
						state = 1071
					}
					state = 1087
					state = 1067
					state = 1079
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_RHP_flag }
						state = 1060
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1069
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1076
					}
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_EXCLUDED_VAR_NEGATIVE }
	}
	else = {
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_VAR_NEGATIVE }
	}
}
KIR_STATE_C23_PALACE_PP = {
	if = {
		limit = {
			THIS = {
				OR = {
					state = 926
					state = 1080
					state = 1082
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1069
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_LLL_flag }
						state = 1076
					}
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_STRONGHOLD_VAR_NEGATIVE }
	}
	else_if = {
		limit = {
			THIS = {
				OR = {
					state = 1059
					state = 1064
					state = 833
					AND = {
						KIR = { has_country_flag = KIR_national_focus_title_3_flag }
						state = 1088
					}
					AND = {
						KIR = { 
							has_country_flag = KIR_national_focus_title_3_flag
							NOT = { has_country_flag = KIR_NAKP_disgraced_flag }
						}
						state = 1071
					}
					state = 1087
					state = 1067
					state = 1079
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_CCH_flag }
						state = 1073
					}
					AND = {
						KIR = { has_country_flag = KIR_STATE_PALACE_COST_RHP_flag }
						state = 1060
					}
				}
			}
		}
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_EXCLUDED_VAR_NEGATIVE }
	}
	else = {
		ROOT = { add_political_power = KIR.KIR_STATE_PALACE_COST_VAR_NEGATIVE }
	}
}
KIR_POST_GGO_INDUSCI_UPGRADE = {
	if = {
		limit = {
			NOT = {
				has_idea = modern_society
			}
		}
		increase_society_development_gradual = yes
	}
	else_if = {
		limit = {
			has_idea = modern_society
		}
		increase_science_base = yes
	}
}

KIR_Get_Balance_of_the_Realm = {
	hidden_effect = {
		### Balance of the Realm DynMod
		add_dynamic_modifier = { modifier = KIR_Balance_Modifier }
		add_dynamic_modifier = { modifier = KIR_Balance_Modifier_Real }
		### Var 1
		clear_variable = KIR.KIR_POSSIBLE_PROVINCIAL_DIETS
		for_each_scope_loop = {
			array = KIR.owned_controlled_states
			if = {
				limit = {
					is_core_of = KIR
				}
				add_to_variable = { KIR.KIR_POSSIBLE_PROVINCIAL_DIETS = 1 }
			}
		}
		set_variable = { KB1M_VAR = KIR.KIR_POSSIBLE_PROVINCIAL_DIETS }
		clear_variable = KIR.KB1AM_VAR
		clear_variable = KIR.KB1A_ALT_M_VAR
		if = {
			limit = {
				check_variable = { KIR.KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier < 10 }
			}
			set_variable = { KB1AM_VAR = KIR.KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier }
			if = {
				limit = {
					check_variable = { KIR.KB1AM_VAR = 0 }
				}
				add_to_variable = { KB1AM_VAR = 0.001 }
			}
		}
		else_if = {
			limit = {
				NOT = { check_variable = { KIR.KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier < 10 } }
			}
			set_variable = { KB1A_ALT_M_VAR = KIR.KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier }
		}
		set_variable = { KB1BM_VAR = KIR.KIR_POSSIBLE_PROVINCIAL_DIETS }
		divide_variable = { KB1BM_VAR = 2 }
		set_variable = { KB1DM_VAR = KIR.KIR_CONSOCSYS_KIR_STATE_DIETS_Modifier }
		subtract_from_variable = { KB1DM_VAR = KIR.KB1BM_VAR }
		if = {
			limit = {
				check_variable = { KIR.KB1DM_VAR > 0 }
			}
			multiply_variable = { KB1DM_VAR = 0.03 }
		}
		else_if = {
			limit = {
				check_variable = { KIR.KB1DM_VAR < 0 }
			}
			multiply_variable = { KB1DM_VAR = 0.05 }
		}
		if = {
			limit = {
				check_variable = { KIR.KB1M_VAR = 0 }
			}
			add_to_variable = { KB1M_VAR = 0.001 }
		}
		if = {
			limit = {
				check_variable = { KIR.KB1BM_VAR = 0 }
			}
			add_to_variable = { KB1BM_VAR = 0.001 }
		}
		if = {
			limit = {
				check_variable = { KIR.KB1DM_VAR = 0 }
			}
			add_to_variable = { KB1DM_VAR = 0.001 }
		}
		### Var 2
		clear_variable = KIR.KIR_POSSIBLE_MAYORALTIES
		for_each_scope_loop = {
			array = KIR.owned_controlled_states
			if = {
				limit = {
					is_core_of = KIR
					has_state_flag = KIR_STATE_HAS_YAMEN
				}
				add_to_variable = { KIR.KIR_POSSIBLE_MAYORALTIES = 1 }
			}
		}
		set_variable = { KB2M_VAR = KIR.KIR_POSSIBLE_MAYORALTIES }
		set_variable = { KB2AM_VAR = KIR.KIR_CONSOCSYS_KIR_STATE_MAYORALTIES_Modifier }
		set_variable = { KB2BM_VAR = KIR.KIR_POSSIBLE_MAYORALTIES }
		divide_variable = { KB2BM_VAR = 2 }
		set_variable = { KB2DM_VAR = KIR.KIR_CONSOCSYS_KIR_STATE_MAYORALTIES_Modifier }
		subtract_from_variable = { KB2DM_VAR = KIR.KB2BM_VAR }
		if = {
			limit = {
				check_variable = { KIR.KB2DM_VAR > 0 }
			}
			multiply_variable = { KB2DM_VAR = 0.03 }
		}
		else_if = {
			limit = {
				check_variable = { KIR.KB2DM_VAR < 0 }
			}
			multiply_variable = { KB2DM_VAR = 0.05 }
		}
		if = {
			limit = {
				check_variable = { KIR.KB2M_VAR = 0 }
			}
			add_to_variable = { KB2M_VAR = 0.001 }
		}
		if = {
			limit = {
				check_variable = { KIR.KB2AM_VAR = 0 }
			}
			add_to_variable = { KB2AM_VAR = 0.001 }
		}
		if = {
			limit = {
				check_variable = { KIR.KB2BM_VAR = 0 }
			}
			add_to_variable = { KB2BM_VAR = 0.001 }
		}
		if = {
			limit = {
				check_variable = { KIR.KB2DM_VAR = 0 }
			}
			add_to_variable = { KB2DM_VAR = 0.001 }
		}
		### Var 3
		clear_variable = KIR.KIR_ACTIVE_SYNERGIES
		for_each_scope_loop = {
			array = KIR.owned_controlled_states
			if = {
				limit = {
					is_core_of = KIR
					has_state_flag = KIR_STATE_HAS_YAMEN
					OR = {
						has_state_flag = KIR_STATE_HAS_H1_SYNERGY
						has_state_flag = KIR_STATE_HAS_H2_SYNERGY
						has_state_flag = KIR_STATE_HAS_H3_SYNERGY
						has_state_flag = KIR_STATE_HAS_N1_SYNERGY
						has_state_flag = KIR_STATE_HAS_N2_SYNERGY
						has_state_flag = KIR_STATE_HAS_N3_SYNERGY
						has_state_flag = KIR_STATE_HAS_N4_SYNERGY
						has_state_flag = KIR_STATE_HAS_N5_SYNERGY
						has_state_flag = KIR_STATE_HAS_C1_SYNERGY
						has_state_flag = KIR_STATE_HAS_C2_SYNERGY
						has_state_flag = KIR_STATE_HAS_C3_SYNERGY
					}
				}
				add_to_variable = { KIR.KIR_ACTIVE_SYNERGIES = 1 }
			}
		}
		set_variable = { KB3M_VAR = KIR.KIR_ACTIVE_SYNERGIES }
		set_variable = { KB3AM_VAR = KIR.KIR_ACTIVE_SYNERGIES }
		multiply_variable = { KB3AM_VAR = 0.03 }
		if = {
			limit = {
				check_variable = { KIR.KB3M_VAR = 0 }
			}
			add_to_variable = { KB3M_VAR = 0.001 }
		}
		if = {
			limit = {
				check_variable = { KIR.KB3AM_VAR = 0 }
			}
			add_to_variable = { KB3AM_VAR = 0.001 }
		}
		### Var 4
		set_variable = { KB4M_VAR = KIR.KIR_CONSOCSYS_KIR_STATE_DIETS_SUSPENDED_Modifier }
		set_variable = { KB4AM_VAR = 0 }
		subtract_from_variable = { KB4AM_VAR = KIR.KIR_CONSOCSYS_KIR_STATE_DIETS_SUSPENDED_Modifier }
		multiply_variable = { KB4AM_VAR = 0.05 }
		if = {
			limit = {
				check_variable = { KIR.KB4M_VAR = 0 }
			}
			add_to_variable = { KB4M_VAR = 0.001 }
		}
		if = {
			limit = {
				check_variable = { KIR.KB4AM_VAR = 0 }
			}
			subtract_from_variable = { KB4AM_VAR = 0.001 }
		}
		### Var 5
		clear_variable = KIR.KBXM_VAR
		add_to_variable = { KBXM_VAR = KIR.KB1DM_VAR }
		add_to_variable = { KBXM_VAR = KIR.KB2DM_VAR }
		add_to_variable = { KBXM_VAR = KIR.KB3AM_VAR }
		add_to_variable = { KBXM_VAR = KIR.KB4AM_VAR }
		add_to_variable = { KBXM_VAR = KIR.KIR_BASE_INSTITUTIONAL_STAB_VAR }
		if = {
			limit = {
				check_variable = { KIR.KBXM_VAR > 0.99 }
			}
			set_variable = { KBXM_VAR = 1 }
		}
		clamp_variable = {
			var = KIR.KBXM_VAR
			min = -1
			max = 1
		}
		### Var 6
		if = {
			limit = {
				check_variable = {
					var = KIR.KBXM_VAR
					value = 0
					compare = greater_than_or_equals
				}
			}
			set_variable = { KBYM_VAR = KIR.KBXM_VAR }
			set_variable = { KBYM1_VAR = KIR.KBXM_VAR }
			set_variable = { KBYM2_VAR = KIR.KBXM_VAR }
			set_variable = { KBYM3_VAR = KIR.KBXM_VAR }
			set_variable = { KBYM4_VAR = KIR.KBXM_VAR }
			set_variable = { KBYM5_VAR = KIR.KBXM_VAR }
			divide_variable = { KBYM_VAR = 5 }
			divide_variable = { KBYM1_VAR = 20 }
			divide_variable = { KBYM2_VAR = 5 }
			divide_variable = { KBYM3_VAR = 5 }
			divide_variable = { KBYM4_VAR = 10 }
			divide_variable = { KBYM5_VAR = 10 }
		}
		else_if = {
			limit = {
				check_variable = {
					var = KIR.KBXM_VAR
					value = 0
					compare = less_than
				}
			}
			set_variable = { KBYM_VAR = KIR.KBXM_VAR }
			set_variable = { KBYM1_VAR = KIR.KBXM_VAR }
			set_variable = { KBYM2_VAR = KIR.KBXM_VAR }
			set_variable = { KBYM3_VAR = KIR.KBXM_VAR }
			set_variable = { KBYM4_VAR = KIR.KBXM_VAR }
			set_variable = { KBYM5_VAR = KIR.KBXM_VAR }
			divide_variable = { KBYM_VAR = 2.5 }
			divide_variable = { KBYM1_VAR = 10 }
			divide_variable = { KBYM2_VAR = 2.5 }
			divide_variable = { KBYM3_VAR = 2.5 }
			divide_variable = { KBYM4_VAR = 5 }
			divide_variable = { KBYM5_VAR = 5 }
		}
	}
}