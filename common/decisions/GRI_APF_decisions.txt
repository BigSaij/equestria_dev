GRI_AP_sc_inquisition_cat = {
	GRI_AP_sc_start_inquisition_target_country = {
		allowed = {
			OR = {
				original_tag = GRI
				original_tag = FAT
			}
		}

		target_array = ROOT.GRI_AF_inquisitionable_cores
		target_non_existing = yes

		visible = {
			has_completed_focus = GRI_AF_sc_territory_integration
			FROM = {
				exists = no
			}
			NOT = {
				meta_trigger = {
					text = {
						is_in_array = {
							array = GRI_AF_under_inquisition_cores
							value = GRI_AF_[TAG_COUNTRY]_inquisition_state
						}
					}

					TAG_COUNTRY = "[FROM.GetTag]"
				}
			}
		}
		available = {
			check_variable = {
				ROOT.GRI_AF_inquisitors_available > 0
			}
			
			meta_trigger = {
				text = {
					controls_state = GRI_AF_[TAG_COUNTRY]_inquisition_state
				}

				TAG_COUNTRY = "[FROM.GetTag]"
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision GRI_AP_sc_inquisition_target_country target: [From.GetName]"
			meta_effect = {
				text = {
					add_to_array = {
						array = GRI_AF_under_inquisition_cores
						value = GRI_AF_[TAG_COUNTRY]_inquisition_state
					}
				}

				TAG_COUNTRY = "[FROM.GetTag]"
			}

		}
	}

	GRI_AP_sc_dispatch_inquisitors_target_state = {
		allowed = {
			OR = {
				original_tag = GRI
				original_tag = FAT
			}
		}

		target_array = ROOT.GRI_AF_under_inquisition_cores
		state_target = yes
		on_map_mode = map_and_decisions_view

		visible = {
			has_completed_focus = GRI_AF_sc_territory_integration
		}
		available = {
			
			always = yes
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision GRI_AP_sc_dispatch_inquisitors_target_state target: [From.GetName]"
			FROM = {
				meta_effect = {
					text = {
						set_variable = { title_event_inquisition  = token:imperium_4002_[TAG]_t }
						set_variable = { desc_event_inquisition   = token:imperium_4002_[TAG]_d }
						set_variable = { resp_event_inquisition   = token:imperium_4002_[TAG]_a }
						set_variable = { effect_event_inquisition = token:imperium_4002_[TAG]_e }
					}
					
					# The hardcoded index (0) is not very modular here.
					TAG = "[?state_original_cores^0.GetTag]"
				}
				state_event = {
					id = imperium.4002
					trigger_for = ROOT
				}
			}
		}
	}

	GRI_AP_add_inquisitor = {
		allowed = {
			original_tag = GRI
		}
		visible = {
			is_debug = yes
		}

		complete_effect = {
			meta_effect = {
				text = {
					set_temp_variable = { temp_var = GRI_AF_[TAG_COUNTRY]_inquisition_state}
				}

				TAG_COUNTRY = "[STW.GetTag]"
			}
			log = "[?temp_var]"
			log = "[?GRI_AF_STW_inquisition_state]"
			var:temp_var = {
				log = "[THIS.GetName]"
			}

			add_to_variable = {
				ROOT.GRI_AF_inquisitors_available = 1
			}
		}
	}
}

GRI_AP_debug_cat = {
	GRI_AP_debug_unlock_super_griffons = {
		allowed = {
			original_tag = GRI
		}
		visible = {
			is_debug = yes
			NOT = {
				has_tech = gri_ap_super_griffons
			}
		}

		complete_effect = {
			set_technology = {
				gri_ap_super_griffons = 1
				gri_ap_super_griffons_basic_equipments = 1
			}
		}
	}

	GRI_AP_debug_unlock_shared_conquest_tree = {
		allowed = {
			OR = {
				original_tag = GRI
			}
		}
		visible = {
			is_debug = yes
		}

		complete_effect = {
			#activate_targeted_decision = {
			#	target = ROOT
			#	decision = GRI_AP_sc_start_inquisition_target_country
			#}
		}
	}
}

GRI_AF_war_dread_flood = {
		icon = generic_intelligence_operation
		allowed = {
		    original_tag = GRI
		}
		available = {
			is_subject = no
		}
		targets = { DED }
		targets_dynamic = yes
		target_trigger = {
			can_declare_war_on = FROM
			FROM = { 
			    original_tag = DED
			}
		}
		target_root_trigger = {
			has_completed_focus = GRI_AF_sc_griffonia_unified
		}
		visible = {
			has_completed_focus = GRI_AF_sc_griffonia_unified
			has_game_rule = {
				rule = DED_APRIL_FOOL = yes
			}
			can_declare_war_on = FROM
			FROM = {
				exists = yes
				NOT = { 
				    has_war_with = ROOT 
				}
				NOT = {
				    is_subject_of = ROOT
				}
			}
		}
		cancel_trigger = {
			OR = {
				is_subject = yes
				NOT = { can_declare_war_on = FROM }
				FROM = {
					OR = {
						exists = no
						is_subject = yes
						has_war_with = ROOT
					}
				}
			}
		}
		
		cost = 0
		fire_only_once = yes
		
		days_remove = 30
		war_with_target_on_remove = yes
		
		ai_will_do = {
			factor = 0
			modifier = {
				factor = 0
				has_war = yes
			}
		}
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision GRI_war_dread target: [From.GetName]"
			FROM = {
                add_ai_strategy = {
                    type = prepare_for_war
                    id = ROOT
                    value = 1000
                }
            }
		}
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove GRI_war_dread target: [From.GetName]"
			FROM = {
                add_ai_strategy = {
                    type = prepare_for_war
                    id = ROOT
                    value = -1000
                }
            }
			hidden_effect = {
				create_wargoal = { 
					type = annex_everything 
					target = FROM
				}
				if = {
				    limit = {
					    FROM = {
						    is_ai = no
						}
					}
				}
			}
			declare_war_on = {
                target = FROM
                type = annex_everything
            }
		}
	}

GRI_AF_war_twilight = {
		icon = generic_intelligence_operation
		allowed = {
		    original_tag = GRI
		}
		available = {
			is_subject = no
		}
		targets = { EQS }
		targets_dynamic = yes
		target_trigger = {
			can_declare_war_on = FROM
			FROM = { 
			    original_tag = EQS
			}
		}
		target_root_trigger = {
			has_completed_focus = GRI_AF_sc_griffonia_unified
		}
		visible = {
			has_completed_focus = GRI_AF_sc_griffonia_unified
			has_game_rule = {
				rule = EQS_STATUS_APRIL_FOOLS = yes
			}
			can_declare_war_on = FROM
			FROM = {
				exists = yes
				NOT = { 
				    has_war_with = ROOT 
				}
				NOT = {
				    is_subject_of = ROOT
				}
			}
		}
		cancel_trigger = {
			OR = {
				is_subject = yes
				NOT = { can_declare_war_on = FROM }
				FROM = {
					OR = {
						exists = no
						is_subject = yes
						has_war_with = ROOT
					}
				}
			}
		}
		
		cost = 0
		fire_only_once = yes
		
		days_remove = 30
		war_with_target_on_remove = yes
		
		ai_will_do = {
			factor = 0
			modifier = {
				factor = 0
				has_war = yes
			}
		}
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision GRI_war_dread target: [From.GetName]"
			FROM = {
                add_ai_strategy = {
                    type = prepare_for_war
                    id = ROOT
                    value = 1000
                }
            }
		}
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove GRI_war_dread target: [From.GetName]"
			FROM = {
                add_ai_strategy = {
                    type = prepare_for_war
                    id = ROOT
                    value = -1000
                }
            }
			hidden_effect = {
				create_wargoal = { 
					type = annex_everything 
					target = FROM
				}
				if = {
				    limit = {
					    FROM = {
						    is_ai = no
						}
					}
				}
			}
			declare_war_on = {
                target = FROM
                type = annex_everything
            }
		}
	}
