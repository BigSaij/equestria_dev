# All the triggers for the NZW War

# NZ1 = island party = normally (currently exclusively even) Hippogriffia
# NZ2 = northern party = normally Colthage
# NZ3 = southern party = normally Chiropterra

# Is the country aligned with the island party
NZW_is_aligned_with_NZ1 = {
	OR = {
		has_country_flag = NZW_country_is_aligned_with_NZ1 # Country flag for special situations
		is_subject_of = NZ1 # Subject counts as aligned
		has_war_with = NZ1 # Special case (e.g. HIP can go to war with WAR or ZUM)
		
		# Owned by NZ1
		all_of_scopes = {
			array = original_cores
			owner = {
				OR = {
					tag = NZ1
					is_subject_of = NZ1
				}
			}
		}
	}
}

# Is the country aligned with the northern party
NZW_is_aligned_with_NZ2 = {
	OR = {
		has_country_flag = NZW_country_is_aligned_with_NZ1 # Country flag for special situations
		is_subject_of = NZ2 # Subject counts as aligned
		has_war_with = NZ2 # Special case (e.g. HIP can go to war with WAR or ZUM)
		
		# Owned by NZ2
		all_of_scopes = {
			array = original_cores
			owner = {
				OR = {
					tag = NZ2
					is_subject_of = NZ2
				}
			}
		}
	}
}

# Is the country aligned with the southern party
NZW_is_aligned_with_NZ3 = {
	OR = {
		has_country_flag = NZW_country_is_aligned_with_NZ1 # Country flag for special situations
		is_subject_of = NZ3 # Subject counts as aligned
		has_war_with = NZ3 # Special case (e.g. HIP can go to war with WAR or ZUM)
		
		# Owned by NZ3
		all_of_scopes = {
			array = original_cores
			owner = {
				OR = {
					tag = NZ3
					is_subject_of = NZ3
				}
			}
		}
	}
}

# Is the country not aligned with anyone
NZW_is_unaligned = {
	AND = {
		NOT = { NZW_is_aligned_with_NZ1 = yes }
		NOT = { NZW_is_aligned_with_NZ2 = yes }
		NOT = { NZW_is_aligned_with_NZ3 = yes }
	}
}

# Is the northern party ready for war
NZW_is_northern_party_ready = {
	custom_effect_tooltip = {
		tooltip = NZW_is_northern_party_ready_tooltip
		NOT = { CTH = { NZW_is_unaligned = yes } }
		NOT = { CVA = { NZW_is_unaligned = yes } }
		NOT = { CDR = { NZW_is_unaligned = yes } }
		NOT = { ZUM = { NZW_is_unaligned = yes } }
	}
}

# Is the southern party ready for war
NZW_is_southern_party_ready = {
	custom_effect_tooltip = {
		tooltip = NZW_is_southern_party_ready_tooltip
		NOT = { BAT = { NZW_is_unaligned = yes } }
		NOT = { TBK = { NZW_is_unaligned = yes } }
		NOT = { ZAR = { NZW_is_unaligned = yes } }
		NOT = { WAR = { NZW_is_unaligned = yes } }
	}
}

# Is this country NZ1 (Island party tag)
NZW_is_NZ1_trigger = {
	# This is going to be made more complicated once (if ever) it actually matters
	original_tag = HIP
}

# Is this country NZ2 (Northern party tag)
NZW_is_NZ2_trigger = {
	# For now, this should be a sufficent condition to figure out the dominant power in North NZ
	875 = { # Colthage
		owner = {
			# first prev -> Colthage state scope, second prev -> scope prior to Colthage state scope (meaning caller scope)	
			OR = {
				tag = PREV.PREV
				is_subject_of = PREV.PREV
			}
			# If you're worried that the subject condition allows outsiders to become a NZW participant, 
			# it doesn't because the tag alias itself is constraint to certain tags
		}
	}
}

# Is this country NZ3 (Southern party tag)
NZW_is_NZ3_trigger = {
	# This one is a bit of a funny one, but everyone winning against BAT takes 691 from them, so this works
	# Can be made more complicated if needed
	691 = { # New Mareidian
		owner = {
			# first prev -> New Mareidian state scope, second prev -> scope prior to Colthage state scope (meaning caller scope)
			OR = {
				tag = PREV.PREV
				is_subject_of = PREV.PREV
			}
			# If you're worried that the subject condition allows outsiders to become a NZW participant, 
			# it doesn't because the tag alias itself is constraint to certain tags
		}
	}
}